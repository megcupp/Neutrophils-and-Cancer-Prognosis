*calculation of power for each individual study included in a meta-analysis
*STATA

clear

import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("All cancers") firstrow,

gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)


/////////////////////////////////////////////////
//                                             //
//                 Mei Z et al.		       //
//	               OS		       //
//					       //
/////////////////////////////////////////////////

*Mei et al power estimate using largest study ln(HR)
power cox -.2231435, n(419)
replace LargestPower = .6270 in 1

power cox -.2231435, n(208)
replace LargestPower = .3628 in 2

power cox -.2231435, n(89)
replace LargestPower = .1821 in 3

power cox -.2231435, n(401)
replace LargestPower = .6081 in 4

power cox -.2231435, n(171)
replace LargestPower = .3082 in 5

power cox -.2231435, n(100)
replace LargestPower = .1993 in 6

power cox -.2231435, n(92)
replace LargestPower = .1868 in 7

power cox -.2231435, n(268)
replace LargestPower = .4469 in 8

power cox -.2231435, n(396)
replace LargestPower = .6027 in 9

power cox -.2231435, n(266)
replace LargestPower = .4442 in 10

power cox -.2231435, n(171)
replace LargestPower = .3082 in 11

power cox -.2231435, n(105)
replace LargestPower = .2071 in 12

power cox -.2231435, n(208)
replace LargestPower = .3628 in 13

power cox -.2231435, n(362)
replace LargestPower = .5647 in 14

power cox -.2231435, n(420)
replace LargestPower = .6280 in 15

power cox -.2231435, n(52)
replace LargestPower = .1240 in 16

power cox -.2231435, n(169)
replace LargestPower = .3052 in 17

power cox -.2231435, n(118)
replace LargestPower = .2272 in 18

power cox -.2231435, n(462)
replace LargestPower = .6694 in 19

power cox -.2231435, n(908)
replace LargestPower = .9195 in 20

power cox -.2231435, n(440)
replace LargestPower = .6482 in 21

power cox -.2231435, n(243)
replace LargestPower = .4127 in 22

power cox -.2231435, n(109)
replace LargestPower = .2133 in 23

power cox -.2231435, n(173)
replace LargestPower = .3112 in 24

power cox -.2231435, n(104)
replace LargestPower = .2055 in 25

power cox -.2231435, n(229)
replace LargestPower = .3930 in 26

power cox -.2231435, n(50)
replace LargestPower = .1208 in 27

power cox -.2231435, n(156)
replace LargestPower = .2855 in 28

power cox -.2231435, n(244)
replace LargestPower = .4140 in 29

power cox -.2231435, n(185)
replace LargestPower = .3291 in 30

power cox -.2231435, n(85)
replace LargestPower = .1758 in 31

power cox -.2231435, n(306)
replace LargestPower = .4967 in 32

power cox -.2231435, n(199)
replace LargestPower = .3497 in 33

power cox -.2231435, n(199)
replace LargestPower = .3497 in 34

power cox -.2231435, n(174)
replace LargestPower = .3127 in 35

power cox -.2231435, n(220)
replace LargestPower = .3801 in 36

power cox -.2231435, n(403)
replace LargestPower = .6102 in 37

power cox -.2231435, n(560)
replace LargestPower = .7518 in 38

power cox -.2231435, n(75)
replace LargestPower = .1602 in 39

power cox -.2231435, n(538)
replace LargestPower = .7350 in 40

power cox -.2231435, n(123)
replace LargestPower = .2350 in 41

power cox -.2231435, n(201)
replace LargestPower = .3527 in 42

power cox -.2231435, n(174)
replace LargestPower = .3127 in 43

power cox -.2231435, n(238)
replace LargestPower = .4057 in 44

*power cox -.2231435, n(?)
*replace LargestPower = .3497 in 45

*power cox -.2231435, n(?)
*replace LargestPower = .3497 in 46

power cox -.2231435, n(74)
replace LargestPower = .1586 in 47

power cox -.2231435, n(118)
replace LargestPower = .2272 in 48

power cox -.2231435, n(292)
replace LargestPower = .4787 in 49

power cox -.2231435, n(873)
replace LargestPower = .9093 in 50

power cox -.2231435, n(185)
replace LargestPower = .3291 in 51

power cox -.2231435, n(114)
replace LargestPower = .2210 in 52

power cox -.2231435, n(78)
replace LargestPower = .1649 in 53

power cox -.2231435, n(185)
replace LargestPower = .3291 in 54

power cox -.2231435, n(1199)
replace LargestPower = .9715 in 55

power cox -.2231435, n(104)
replace LargestPower = .2055 in 56

power cox -.2231435, n(145)
replace LargestPower = .2688 in 57

power cox -.2231435, n(1224)
replace LargestPower = .9740 in 58

power cox -.2231435, n(177)
replace LargestPower = .3172 in 59

power cox -.2231435, n(137)
replace LargestPower = .2565 in 60

power cox -.2231435, n(497)
replace LargestPower = .7010 in 61

power cox -.2231435, n(366)
replace LargestPower = .5693 in 62

power cox -.2231435, n(1220)
replace LargestPower = .9736 in 63

power cox -.2231435, n(115)
replace LargestPower = .2226 in 64

power cox -.2231435, n(373)
replace LargestPower = .5772 in 65


*Mei et al power estimate using fixed study ln(HR)
power cox 0.0953102, n(419)
replace FixedPower = .1624 in 1

power cox 0.0953102, n(208)
replace FixedPower = .1016 in 2

power cox 0.0953102, n(89)
replace FixedPower = .0655 in 3

power cox 0.0953102, n(401)
replace FixedPower = .1573 in 4

power cox 0.0953102, n(171)
replace FixedPower = .0906 in 5

power cox 0.0953102, n(100)
replace FixedPower = .0690 in 6

power cox 0.0953102, n(92)
replace FixedPower = .0664 in 7

power cox 0.0953102, n(268)
replace FixedPower = .1190 in 8

power cox 0.0953102, n(396)
replace FixedPower = .1559 in 9

power cox 0.0953102, n(266)
replace FixedPower = .1185 in 10

power cox 0.0953102, n(171)
replace FixedPower = .0906 in 11

power cox 0.0953102, n(105)
replace FixedPower = .0706 in 12

power cox 0.0953102, n(208)
replace FixedPower = .1016 in 13

power cox 0.0953102, n(362)
replace FixedPower = .1461 in 14

power cox 0.0953102, n(420)
replace FixedPower = .1627 in 15

power cox 0.0953102, n(52)
replace FixedPower = .0530 in 16

power cox 0.0953102, n(169)
replace FixedPower = .0900 in 17

power cox 0.0953102, n(118)
replace FixedPower = .0746 in 18

power cox 0.0953102, n(462)
replace FixedPower = .1747 in 19

power cox 0.0953102, n(908)
replace FixedPower = .3001 in 20

power cox 0.0953102, n(440)
replace FixedPower = .1684 in 21

power cox 0.0953102, n(243)
replace FixedPower = .1118 in 22

power cox 0.0953102, n(109)
replace FixedPower = .0718 in 23

power cox 0.0953102, n(173)
replace FixedPower = .0912 in 24

power cox 0.0953102, n(104)
replace FixedPower = .0702 in 25

power cox 0.0953102, n(229)
replace FixedPower = .1077 in 26

power cox 0.0953102, n(50)
replace FixedPower = .0523 in 27

power cox 0.0953102, n(156)
replace FixedPower = .0862 in 28

power cox 0.0953102, n(244)
replace FixedPower = .1121 in 29

power cox 0.0953102, n(185)
replace FixedPower = .0948 in 30

power cox 0.0953102, n(85)
replace FixedPower = .0642 in 31

power cox 0.0953102, n(306)
replace FixedPower = .1300 in 32

power cox 0.0953102, n(199)
replace FixedPower = .0989 in 33

power cox 0.0953102, n(199)
replace FixedPower = .0989 in 34

power cox 0.0953102, n(174)
replace FixedPower = .0915 in 35

power cox 0.0953102, n(220)
replace FixedPower = .1051 in 36

power cox 0.0953102, n(403)
replace FixedPower = .1579 in 37

power cox 0.0953102, n(560)
replace FixedPower = .2026 in 38

power cox 0.0953102, n(75)
replace FixedPower = .0609 in 39

power cox 0.0953102, n(538)
replace FixedPower = .1964 in 40

power cox 0.0953102, n(123)
replace FixedPower = .0762 in 41

power cox 0.0953102, n(201)
replace FixedPower = .0995 in 42

power cox 0.0953102, n(174)
replace FixedPower = .0915 in 43

power cox 0.0953102, n(238)
replace FixedPower = .1103 in 44

*power cox 0.0953102, n(?)
*replace FixedPower = .x in 45

*power cox 0.0953102, n(?)
*replace FixedPower = .x in 46

power cox 0.0953102, n(74)
replace FixedPower = .0606 in 47

power cox 0.0953102, n(118)
replace FixedPower = .0746 in 48

power cox 0.0953102, n(292)
replace FixedPower = .1260 in 49

power cox 0.0953102, n(873)
replace FixedPower = .2905 in 50

power cox 0.0953102, n(185)
replace FixedPower = .0948 in 51

power cox 0.0953102, n(114)
replace FixedPower = .0734 in 52

power cox 0.0953102, n(78)
replace FixedPower = .0619 in 53

power cox 0.0953102, n(185)
replace FixedPower = .0948 in 54

power cox 0.0953102, n(1199)
replace FixedPower = .3783 in 55

power cox 0.0953102, n(104)
replace FixedPower = .0702 in 56

power cox 0.0953102, n(145)
replace FixedPower = .0829 in 57

power cox 0.0953102, n(1224)
replace FixedPower = .3849 in 58

power cox 0.0953102, n(177)
replace FixedPower = .0924 in 59

power cox 0.0953102, n(137)
replace FixedPower = .0804 in 60

power cox 0.0953102, n(497)
replace FixedPower = .1847 in 61

power cox 0.0953102, n(366)
replace FixedPower = .1473 in 62

power cox 0.0953102, n(1220)
replace FixedPower = .3838 in 63

power cox 0.0953102, n(115)
replace FixedPower = .0737 in 64

power cox 0.0953102, n(373)
replace FixedPower = .1493 in 65


*Mei et al power estimate using random study ln(HR)
power cox 0.5306283, n(419)
replace RandomPower = .9997 in 1

power cox 0.5306283, n(208)
replace RandomPower = .9690 in 2

power cox 0.5306283, n(89)
replace RandomPower = .7064 in 3

power cox 0.5306283, n(401)
replace RandomPower = .9996 in 4

power cox 0.5306283, n(171)
replace RandomPower = .9344 in 5

power cox 0.5306283, n(100)
replace RandomPower = .7559 in 6

power cox 0.5306283, n(92)
replace RandomPower = .7207 in 7

power cox 0.5306283, n(268)
replace RandomPower = .9914 in 8

power cox 0.5306283, n(396)
replace RandomPower = .9995 in 9

power cox 0.5306283, n(266)
replace RandomPower = .9910 in 10

power cox 0.5306283, n(171)
replace RandomPower = .9344 in 11

power cox 0.5306283, n(105)
replace RandomPower = .7760 in 12

power cox 0.5306283, n(208)
replace RandomPower = .9690 in 13

power cox 0.5306283, n(362)
replace RandomPower = .9990 in 14

power cox 0.5306283, n(420)
replace RandomPower = .9997 in 15

power cox 0.5306283, n(52)
replace RandomPower = .4814 in 16

power cox 0.5306283, n(169)
replace RandomPower = .9318 in 17

power cox 0.5306283, n(118)
replace RandomPower = .8218 in 18

power cox 0.5306283, n(462)
replace RandomPower = .9999 in 19

power cox 0.5306283, n(908)
replace RandomPower = 1.000 in 20

power cox 0.5306283, n(440)
replace RandomPower = .9998 in 21

power cox 0.5306283, n(243)
replace RandomPower = .9852 in 22

power cox 0.5306283, n(109)
replace RandomPower = .7910 in 23

power cox 0.5306283, n(173)
replace RandomPower = .9370 in 24

power cox 0.5306283, n(104)
replace RandomPower = .7721 in 25

power cox 0.5306283, n(229)
replace RandomPower = .9801 in 26

power cox 0.5306283, n(50)
replace RandomPower = .4666 in 27

power cox 0.5306283, n(156)
replace RandomPower = .9121 in 28

power cox 0.5306283, n(244)
replace RandomPower = .9855 in 29

power cox 0.5306283, n(185)
replace RandomPower = .9504 in 30

power cox 0.5306283, n(85)
replace RandomPower = .6866 in 31

power cox 0.5306283, n(306)
replace RandomPower = .9963 in 32

power cox 0.5306283, n(199)
replace RandomPower = .9627 in 33

power cox 0.5306283, n(199)
replace RandomPower = .9627 in 34

power cox 0.5306283, n(174)
replace RandomPower = .9382 in 35

power cox 0.5306283, n(220)
replace RandomPower = .9759 in 36

power cox 0.5306283, n(403)
replace RandomPower = .9996 in 37

power cox 0.5306283, n(560)
replace RandomPower = 1.000 in 38

power cox 0.5306283, n(75)
replace RandomPower = .6322 in 39

power cox 0.5306283, n(538)
replace RandomPower = 1.000 in 40

power cox 0.5306283, n(123)
replace RandomPower = .8371 in 41

power cox 0.5306283, n(201)
replace RandomPower = .9642 in 42

power cox 0.5306283, n(174)
replace RandomPower = .9382 in 43

power cox 0.5306283, n(238)
replace RandomPower = .9835 in 44

*power cox 0.5306283, n(?)
*replace RandomPower = .x in 45

*power cox 0.5306283, n(?)
*replace RandomPower = .x in 46

power cox 0.5306283, n(74)
replace RandomPower = .6264 in 47

power cox 0.5306283, n(118)
replace RandomPower = .8218 in 48

power cox 0.5306283, n(292)
replace RandomPower = .9950 in 49

power cox 0.5306283, n(873)
replace RandomPower = 1.000 in 50

power cox 0.5306283, n(185)
replace RandomPower = .9504 in 51

power cox 0.5306283, n(114)
replace RandomPower = .8086 in 52

power cox 0.5306283, n(78)
replace RandomPower = .6492 in 53

power cox 0.5306283, n(185)
replace RandomPower = .9504 in 54

power cox 0.5306283, n(1199)
replace RandomPower = 1.000 in 55

power cox 0.5306283, n(104)
replace RandomPower = .7721 in 56

power cox 0.5306283, n(145)
replace RandomPower = .8916 in 57

power cox 0.5306283, n(1224)
replace RandomPower = 1.000 in 58

power cox 0.5306283, n(177)
replace RandomPower = .9418 in 59

power cox 0.5306283, n(137)
replace RandomPower = .8740 in 60

power cox 0.5306283, n(497)
replace RandomPower = 1.000 in 61

power cox 0.5306283, n(366)
replace RandomPower = .9991 in 62

power cox 0.5306283, n(1220)
replace RandomPower = 1.000 in 63

power cox 0.5306283, n(115)
replace RandomPower = .8120 in 64

power cox 0.5306283, n(373)
replace RandomPower = .9992 in 65


/////////////////////////////////////////////////
//					       //
//  		 Paramanathan A et al.	       //
//			  DFS		       //
//					       //
/////////////////////////////////////////////////

*Paramanathan et al power estimate using largest study ln(HR)

power cox 0.1823216, n(115)
replace LargestPower = .1630 in 66

power cox 0.1823216, n(1788)
replace LargestPower = .9709 in 67

power cox 0.1823216, n(1943)
replace LargestPower = .9802 in 68

power cox 0.1823216, n(414)
replace LargestPower = .4581 in 69

power cox 0.1823216, n(96)
replace LargestPower = .1430 in 70

power cox 0.1823216, n(101)
replace LargestPower = .1483 in 71

power cox 0.1823216, n(440)
replace LargestPower = .4810 in 72

power cox 0.1823216, n(150)
replace LargestPower = .1995 in 73

power cox 0.1823216, n(1040)
replace LargestPower = .8364 in 74

power cox 0.1823216, n(293)
replace LargestPower = .3447 in 75

power cox 0.1823216, n(149)
replace LargestPower = .1984 in 76

power cox 0.1823216, n(297)
replace LargestPower = .3487 in 77

power cox 0.1823216, n(174)
replace LargestPower = .2244 in 78

power cox 0.1823216, n(192)
replace LargestPower = .2430 in 79

power cox 0.1823216, n(250)
replace LargestPower = .3020 in 80

power cox 0.1823216, n(335)
replace LargestPower = .3854 in 81

power cox 0.1823216, n(678)
replace LargestPower = .6605 in 82

power cox 0.1823216, n(295)
replace LargestPower = .3467 in 83

power cox 0.1823216, n(260)
replace LargestPower = .3121 in 84

power cox 0.1823216, n(324)
replace LargestPower = .3748 in 85


*Paramanathan et al power estimate using fixed study ln(HR)

power cox 0.2546422, n(115)
replace FixedPower = .2761 in 66

power cox 0.2546422, n(1788)
replace FixedPower = .9997 in 67

power cox 0.2546422, n(1943)
replace FixedPower = .9999 in 68

power cox 0.2546422, n(414)
replace FixedPower = .7359 in 69

power cox 0.2546422, n(96)
replace FixedPower = .2381 in 70

power cox 0.2546422, n(101)
replace FixedPower = .2481 in 71

power cox 0.2546422, n(440)
replace FixedPower = .7614 in 72

power cox 0.2546422, n(150)
replace FixedPower = .3444 in 73

power cox 0.2546422, n(1040)
replace FixedPower = .9841 in 74

power cox 0.2546422, n(293)
replace FixedPower = .5868 in 75

power cox 0.2546422, n(149)
replace FixedPower = .3424 in 76

power cox 0.2546422, n(297)
replace FixedPower = .5926 in 77

power cox 0.2546422, n(174)
replace FixedPower = .3896 in 78

power cox 0.2546422, n(192)
replace FixedPower = .4224 in 79

power cox 0.2546422, n(250)
replace FixedPower = .5212 in 80

power cox 0.2546422, n(335)
replace FixedPower = .6445 in 81

power cox 0.2546422, n(678)
replace FixedPower = .9123 in 82

power cox 0.2546422, n(295)
replace FixedPower = .5897 in 83

power cox 0.2546422, n(260)
replace FixedPower = .5371 in 84

power cox 0.2546422, n(324)
replace FixedPower = .6300 in 85


*Paramanathan et al power estimate using random study ln(HR)

power cox 0.6830968, n(115)
replace RandomPower = .9557 in 66

power cox 0.6830968, n(1788)
replace RandomPower = 1.000 in 67

power cox 0.6830968, n(1943)
replace RandomPower = 1.000 in 68

power cox 0.6830968, n(414)
replace RandomPower = 1.000 in 69

power cox 0.6830968, n(96)
replace RandomPower = .9172 in 70

power cox 0.6830968, n(101)
replace RandomPower = .9296 in 71

power cox 0.6830968, n(440)
replace RandomPower = 1.000 in 72

power cox 0.6830968, n(150)
replace RandomPower = .9869 in 73

power cox 0.6830968, n(1040)
replace RandomPower = 1.000 in 74

power cox 0.6830968, n(293)
replace RandomPower = .9999 in 75

power cox 0.6830968, n(149)
replace RandomPower = .9864 in 76

power cox 0.6830968, n(297)
replace RandomPower = 1.000 in 77

power cox 0.6830968, n(174)
replace RandomPower = .9945 in 78

power cox 0.6830968, n(192)
replace RandomPower = .9972 in 79

power cox 0.6830968, n(250)
replace RandomPower = .9997 in 80

power cox 0.6830968, n(335)
replace RandomPower = 1.000 in 81

power cox 0.6830968, n(678)
replace RandomPower = 1.000 in 82

power cox 0.6830968, n(295)
replace RandomPower = 1.000 in 83

power cox 0.6830968, n(260)
replace RandomPower = .9998 in 84

power cox 0.6830968, n(324)
replace RandomPower = 1.000 in 85



/////////////////////////////////////////////////
//					       //
//  		    Mei Z et al.               //
//		        PFS		       //
//					       //
/////////////////////////////////////////////////

*Mei et al power estimate using largest study ln(HR)

power cox 0.5481214, n(401)
replace LargestPower = .9998 in 86

power cox 0.5481214, n(85)
replace LargestPower = .7146 in 87

power cox 0.5481214, n(112)
replace LargestPower = .8265 in 88

power cox 0.5481214, n(100)
replace LargestPower = .7825 in 89

power cox 0.5481214, n(268)
replace LargestPower = .9942 in 90

power cox 0.5481214, n(171)
replace LargestPower = .9478 in 91

power cox 0.5481214, n(118)
replace LargestPower = .8454 in 92

power cox 0.5481214, n(462)
replace LargestPower = 1.000 in 93

power cox 0.5481214, n(908)
replace LargestPower = 1.000 in 94

power cox 0.5481214, n(440)
replace LargestPower = .9999 in 95

power cox 0.5481214, n(243)
replace LargestPower = .9896 in 96

power cox 0.5481214, n(109)
replace LargestPower = .8163 in 97

power cox 0.5481214, n(173)
replace LargestPower = .95 in 98

power cox 0.5481214, n(50)
replace LargestPower = .4912 in 99

power cox 0.5481214, n(156)
replace LargestPower = .9283 in 100

power cox 0.5481214, n(244)
replace LargestPower = .9899 in 101

power cox 0.5481214, n(199)
replace LargestPower = .9717 in 102

power cox 0.5481214, n(118)
replace LargestPower = .8454 in 103

power cox 0.5481214, n(292)
replace LargestPower = .9968 in 104

power cox 0.5481214, n(104)
replace LargestPower = .7981 in 105

power cox 0.5481214, n(366)
replace LargestPower = .9995 in 106

power cox 0.5481214, n(115)
replace LargestPower = .8362 in 107

power cox 0.5481214, n(373)
replace LargestPower = .9996 in 108

*Mei et al power estimate using fixed study ln(HR)

power cox 0.2231435, n(401)
replace FixedPower = .6081 in 86

power cox 0.2231435, n(85)
replace FixedPower = .1758 in 87

power cox 0.2231435, n(112)
replace FixedPower = .2179 in 88

power cox 0.2231435, n(100)
replace FixedPower = .1993 in 89

power cox 0.2231435, n(268)
replace FixedPower = .4469 in 90

power cox 0.2231435, n(171)
replace FixedPower = .3082 in 91

power cox 0.2231435, n(118)
replace FixedPower = .2272 in 92

power cox 0.2231435, n(462)
replace FixedPower = .6694 in 93

power cox 0.2231435, n(908)
replace FixedPower = .9195 in 94

power cox 0.2231435, n(440)
replace FixedPower = .6482 in 95

power cox 0.2231435, n(243)
replace FixedPower = .4127 in 96

power cox 0.2231435, n(109)
replace FixedPower = .2133 in 97

power cox 0.2231435, n(173)
replace FixedPower = .3112 in 98

power cox 0.2231435, n(50)
replace FixedPower = .1208 in 99

power cox 0.2231435, n(156)
replace FixedPower = .2855 in 100

power cox 0.2231435, n(244)
replace FixedPower = .4140 in 101

power cox 0.2231435, n(199)
replace FixedPower = .3497 in 102

power cox 0.2231435, n(118)
replace FixedPower = .2272 in 103

power cox 0.2231435, n(292)
replace FixedPower = .4787 in 104

power cox 0.2231435, n(104)
replace FixedPower = .2055 in 105

power cox 0.2231435, n(366)
replace FixedPower = .5693 in 106

power cox 0.2231435, n(115)
replace FixedPower = .2226 in 107

power cox 0.2231435, n(373)
replace FixedPower = .5772 in 108


*Mei et al power estimate using random study ln(HR)

power cox 0.48858, n(401)
replace RandomPower = .9983 in 86

power cox 0.48858, n(85)
replace RandomPower = .6150 in 87

power cox 0.48858, n(112)
replace RandomPower = .7341 in 88

power cox 0.48858, n(100)
replace RandomPower = .6854 in 89

power cox 0.48858, n(268)
replace RandomPower = .9793 in 90

power cox 0.48858, n(171)
replace RandomPower = .8915 in 91

power cox 0.48858, n(118)
replace RandomPower = .7561 in 92

power cox 0.48858, n(462)
replace RandomPower = .9995 in 93

power cox 0.48858, n(908)
replace RandomPower = 1.000 in 94

power cox 0.48858, n(440)
replace RandomPower = .9992 in 95

power cox 0.48858, n(243)
replace RandomPower = .9677 in 96

power cox 0.48858, n(109)
replace RandomPower = .7226 in 97

power cox 0.48858, n(173)
replace RandomPower = .8949 in 98

power cox 0.48858, n(50)
replace RandomPower = .4080 in 99

power cox 0.48858, n(156)
replace RandomPower = .8624 in 100

power cox 0.48858, n(244)
replace RandomPower = .9683 in 101

power cox 0.48858, n(199)
replace RandomPower = .9314 in 102

power cox 0.48858, n(118)
replace RandomPower = .7561 in 103

power cox 0.48858, n(292)
replace RandomPower = .9866 in 104

power cox 0.48858, n(104)
replace RandomPower = .7024 in 105

power cox 0.48858, n(366)
replace RandomPower = .9967 in 106

power cox 0.48858, n(115)
replace RandomPower = .7453 in 107

power cox 0.48858, n(373)
replace RandomPower = .9971 in 108




/////////////////////////////////////////////////
//					       //
//  	           Shen M et al.	       //
//			CSS	               //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)

power cox 1.141033, n(121)
replace LargestPower = 1.000 in 109

power cox 1.141033, n(186)
replace LargestPower = 1.000 in 110

*Shen et al power estimate using fixed study ln(HR)

power cox 1.211941, n(121)
replace FixedPower = 1.000 in 109

power cox 1.211941, n(186)
replace FixedPower = 1.000 in 110

*Shen et al power estimate using random study ln(HR)

power cox 1.211941, n(121)
replace RandomPower = 1.000 in 109

power cox 1.211941, n(186)
replace RandomPower = 1.000 in 110




/////////////////////////////////////////////////
//					       //
//  	           Shen M et al.	       //
//			 OS		       //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)

power cox .14842, n(273)
replace LargestPower = .2315 in 111

power cox .14842, n(85)
replace LargestPower = .1010 in 112

power cox .14842, n(121)
replace LargestPower = .1264 in 113

power cox .14842, n(40)
replace LargestPower = .0680 in 114

power cox .14842, n(200)
replace LargestPower = .1813 in 115

power cox .14842, n(281)
replace LargestPower = .2370 in 116

power cox .14842, n(123)
replace LargestPower = .1278 in 117

power cox .14842, n(632)
replace LargestPower = .4624 in 118

power cox .14842, n(186)
replace LargestPower = .1716 in 119

power cox .14842, n(229)
replace LargestPower = .2013 in 120

power cox .14842, n(115)
replace LargestPower = .1222 in 121

power cox .14842, n(323)
replace LargestPower = .2656 in 122

power cox .14842, n(335)
replace LargestPower = .2737 in 123

power cox .14842, n(97)
replace LargestPower = .1095 in 124

power cox .14842, n(83)
replace LargestPower = .0996 in 125

power cox .14842, n(212)
replace LargestPower = .1896 in 126

*Shen et al power estimate using fixed study ln(HR)

power cox .3784364, n(273)
replace FixedPower = .8783 in 111

power cox .3784364, n(85)
replace FixedPower = .4147 in 112

power cox .3784364, n(121)
replace FixedPower = .5483 in 113

power cox .3784364, n(40)
replace FixedPower = .2227 in 114

power cox .3784364, n(200)
replace FixedPower = .7630 in 115

power cox .3784364, n(281)
replace FixedPower = .8872 in 116

power cox .3784364, n(123)
replace FixedPower = .5551 in 117

power cox .3784364, n(632)
replace FixedPower = .9974 in 118

power cox .3784364, n(186)
replace FixedPower = .7326 in 119

power cox .3784364, n(229)
replace FixedPower = .8169 in 120

power cox .3784364, n(115)
replace FixedPower = .5276 in 121

power cox .3784364, n(323)
replace FixedPower = .9252 in 122

power cox .3784364, n(335)
replace FixedPower = .9336 in 123

power cox .3784364, n(97)
replace FixedPower = .4616 in 124

power cox .3784364, n(83)
replace FixedPower = .4067 in 125

power cox .3784364, n(212)
replace FixedPower = .7867 in 126

*Shen et al power estimate using random study ln(HR)

power cox .5068176, n(273)
replace RandomPower = .9870 in 111

power cox .5068176, n(85)
replace RandomPower = .6467 in 112

power cox .5068176, n(121)
replace RandomPower = .7960 in 113

power cox .5068176, n(40)
replace RandomPower = .3604 in 114

power cox .5068176, n(200)
replace RandomPower = .9478 in 115

power cox .5068176, n(281)
replace RandomPower = .9889 in 116

power cox .5068176, n(123)
replace RandomPower = .8025 in 117

power cox .5068176, n(632)
replace RandomPower = 1.000 in 118

power cox .5068176, n(186)
replace RandomPower = .9327 in 119

power cox .5068176, n(229)
replace RandomPower = .9696 in 120

power cox .5068176, n(115)
replace RandomPower = .7756 in 121

power cox .5068176, n(323)
replace RandomPower = .9953 in 122

power cox .5068176, n(335)
replace RandomPower = .9963 in 123

power cox .5068176, n(97)
replace RandomPower = .7040 in 124

power cox .5068176, n(83)
replace RandomPower = .6363 in 125

power cox .5068176, n(212)
replace RandomPower = .9582 in 126



/////////////////////////////////////////////////
//					       //
//  	          Shen M et al.		       //
//		       OS		       //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)

power cox .0582689, n(200)
replace LargestPower = .0608 in 127

power cox .0582689, n(335)
replace LargestPower = .0768 in 128

*Shen et al power estimate using fixed study ln(HR)

power cox .2311117, n(200)
replace FixedPower = .3723 in 127

power cox .2311117, n(335)
replace FixedPower = .5616 in 128

*Shen et al power estimate using random study ln(HR)

power cox .5068176, n(200)
replace RandomPower = .9478 in 127

power cox .5068176, n(335)
replace RandomPower = .9963 in 128



/////////////////////////////////////////////////
//					       //
//  	           Shen M et al.	       //
//		        OS		       //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)

power cox -.0725707, n(200)
replace LargestPower = .0740 in 129

power cox -.0725707, n(335)
replace LargestPower = .0975 in 130

*Shen et al power estimate using fixed study ln(HR)

power cox .0676586, n(200)
replace FixedPower = .0692 in 129

power cox .0676586, n(335)
replace FixedPower = .0900 in 130

*Shen et al power estimate using random study ln(HR)

power cox .0953102, n(200)
replace RandomPower = .0992 in 129

power cox .0953102, n(335)
replace RandomPower = .1384 in 130


/////////////////////////////////////////////////
//					       //
//  	              Li Y et al.              //
//		          OS		       //
//					       //
/////////////////////////////////////////////////

*Li et al power estimate using largest study ln(HR)

power cox 1.635106, n(142)
replace LargestPower = 1.000 in 131

power cox 1.635106, n(223)
replace LargestPower = 1.000 in 132

power cox 1.635106, n(129)
replace LargestPower = 1.000 in 133

*Li et al power estimate using fixed study ln(HR)

power cox 1.321756, n(142)
replace FixedPower = 1.000 in 131

power cox 1.321756, n(223)
replace FixedPower = 1.000 in 132

power cox 1.321756, n(129)
replace FixedPower = 1.000 in 133

*Li et al power estimate using random study ln(HR)

power cox 1.321756, n(142)
replace RandomPower = 1.000 in 131

power cox 1.321756, n(223)
replace RandomPower = 1.000 in 132

power cox 1.321756, n(129)
replace RandomPower = 1.000 in 133

export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Allcancers.xlsx"

**power of individual studies in gynaecological cancers

clear
 
import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("Gynecological") firstrow
 
gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)
 
/////////////////////////////////////////////////
//					       //
//  	         Ethier JL Z et al.	       //
//		     Breast OS		       //
//					       //
/////////////////////////////////////////////////

*Ethier et al power estimate using largest study ln(HR)
power cox .48858, n(316)
replace LargestPower = .9914 in 1

power cox .48858, n(437)
replace LargestPower = .9992 in 2

power cox .48858, n(85)
replace LargestPower = .6150 in 3

power cox .48858, n(1527)
replace LargestPower = 1.000 in 4

power cox .48858, n(720)
replace LargestPower = 1.000 in 5

power cox .48858, n(1570)
replace LargestPower = 1.000 in 6

power cox .48858, n(157)
replace LargestPower = .8645 in 7

power cox .48858, n(1435)
replace LargestPower = 1.000 in 8

power cox .48858, n(167)
replace LargestPower = .8843 in 9

power cox .48858, n(442)
replace LargestPower = .9993 in 10

power cox .48858, n(90)
replace LargestPower = .6397 in 11

power cox .48858, n(461)
replace LargestPower = .9995 in 12

power cox .48858, n(608)
replace LargestPower = 1.000 in 13

*Ethier et al power estimate using fixed study ln(HR)
power cox .7608058, n(316)
replace FixedPower = 1.000 in 1

power cox .7608058, n(437)
replace FixedPower = 1.000 in 2

power cox .7608058, n(85)
replace FixedPower = .9391 in 3

power cox .7608058, n(1527)
replace FixedPower = 1.000 in 4

power cox .7608058, n(720)
replace FixedPower = 1.000 in 5

power cox .7608058, n(1570)
replace FixedPower = 1.000 in 6

power cox .7608058, n(157)
replace FixedPower = .9975 in 7

power cox .7608058, n(1435)
replace FixedPower = 1.000 in 8

power cox .7608058, n(167)
replace FixedPower = .9984 in 9

power cox .7608058, n(442)
replace FixedPower = 1.000 in 10

power cox .7608058, n(90)
replace FixedPower = .9504 in 11

power cox .7608058, n(461)
replace FixedPower = 1.000 in 12

power cox .7608058, n(608)
replace FixedPower = 1.000 in 13

*Ethier et al power estimate using random study ln(HR)
power cox .9400073, n(316)
replace RandomPower = 1.000 in 1

power cox .9400073, n(437)
replace RandomPower = 1.000 in 2

power cox .9400073, n(85)
replace RandomPower = .9912 in 3

power cox .9400073, n(1527)
replace RandomPower = 1.000 in 4

power cox .9400073, n(720)
replace RandomPower = 1.000 in 5

power cox .9400073, n(1570)
replace RandomPower = 1.000 in 6

power cox .9400073, n(157)
replace RandomPower = .9975 in 7

power cox .9400073, n(1435)
replace RandomPower = 1.000 in 8

power cox .9400073, n(167)
replace RandomPower = .9984 in 9

power cox .9400073, n(442)
replace RandomPower = 1.000 in 10

power cox .9400073, n(90)
replace RandomPower = .9938 in 11

power cox .9400073, n(461)
replace RandomPower = 1.000 in 12

power cox .9400073, n(608)
replace RandomPower = 1.000 in 13

 
/////////////////////////////////////////////////
//					       //
//  	         Ethier JL Z et al.	       //
//		    Breast DFS		       //
//					       //
/////////////////////////////////////////////////

*Ethier et al power estimate using largest study ln(HR)
power cox .4054651, n(61)
replace LargestPower = .3432 in 14

power cox .48858, n(90)
replace LargestPower = .6397 in 15

power cox .48858, n(85)
replace LargestPower = .6150 in 16

power cox .48858, n(157)
replace LargestPower = .8645 in 17

power cox .48858, n(167)
replace LargestPower = .8843 in 18

power cox .48858, n(720)
replace LargestPower = 1.000 in 19

power cox .48858, n(487)
replace LargestPower = .9997 in 20

power cox .48858, n(1527)
replace LargestPower = 1.000 in 21

power cox .48858, n(1570)
replace LargestPower = 1.000 in 22

*Ethier et al power estimate using fixed study ln(HR)
power cox .5247285, n(61)
replace FixedPower = .5355 in 14

power cox .5247285, n(90)
replace FixedPower = .7016 in 15

power cox .5247285, n(85)
replace FixedPower = .6769 in 16

power cox .5247285, n(157)
replace FixedPower = .9078 in 17

power cox .5247285, n(167)
replace FixedPower = .9237 in 18

power cox .5247285, n(720)
replace FixedPower = 1.000 in 19

power cox .5247285, n(487)
replace FixedPower = .9999 in 20

power cox .5247285, n(1527)
replace FixedPower = 1.000 in 21

power cox .5247285, n(1570)
replace FixedPower = 1.000 in 22

*Ethier et al power estimate using random study ln(HR)
power cox .5538851, n(61)
replace RandomPower = .5804 in 14

power cox .5538851, n(90)
replace RandomPower = .7477 in 15

power cox .5538851, n(85)
replace RandomPower = .7235 in 16

power cox .5538851, n(157)
replace RandomPower = .9345 in 17

power cox .5538851, n(167)
replace RandomPower = .9473 in 18

power cox .5538851, n(720)
replace RandomPower = 1.000 in 19

power cox .5538851, n(487)
replace RandomPower = 1.000 in 20

power cox .5538851, n(1527)
replace RandomPower = 1.000 in 21

power cox .5538851, n(1570)
replace RandomPower = 1.000 in 22

 
/////////////////////////////////////////////////
//				 	       //
//  	         Ethier JL Z et al.  	       //
//		       Gyno OS		       //
//					       //
/////////////////////////////////////////////////

*Ethier et al power estimate using largest study ln(HR)
power cox .2623643, n(235)
replace LargestPower = .5203 in 23

power cox .2623643, n(315)
replace LargestPower = .6437 in 24

power cox .2623643, n(407)
replace LargestPower = .7538 in 25

power cox .2623643, n(192)
replace LargestPower = .4434 in 26

power cox .2623643, n(2456)
replace LargestPower = 1.000 in 27

power cox .2623643, n(605)
replace LargestPower = .8974 in 28

power cox .2623643, n(234)
replace LargestPower = .5186 in 29

power cox .2623643, n(875)
replace LargestPower = .9726 in 30

power cox .2623643, n(91)
replace LargestPower = .2393 in 31

power cox .2623643, n(95)
replace LargestPower = .2478 in 32

power cox .2623643, n(36)
replace LargestPower = .1204 in 33

power cox .2623643, n(320)
replace LargestPower = .6505 in 34

power cox .2623643, n(109)
replace LargestPower = .2775 in 35

power cox .2623643, n(1061)
replace LargestPower = .9896 in 36

power cox .2623643, n(282)
replace LargestPower = .5960 in 37

power cox .2623643, n(541)
replace LargestPower = .8624 in 38

power cox .2623643, n(344)
replace LargestPower = .6819 in 39

power cox .2623643, n(56)
replace LargestPower = .1640 in 40

power cox .2623643, n(32)
replace LargestPower = .1116 in 41

power cox .2623643, n(235)
replace LargestPower = .5203 in 42

power cox .2623643, n(508)
replace LargestPower = .8406 in 43

power cox .2623643, n(129)
replace LargestPower = .3192 in 44

power cox .2623643, n(143)
replace LargestPower = .3478 in 45

power cox .2623643, n(60)
replace LargestPower = .1726 in 46

power cox .2623643, n(519)
replace LargestPower = .8482 in 47

power cox .2623643, n(190)
replace LargestPower = .4397 in 48

power cox .2623643, n(460)
replace LargestPower = .8033 in 49

*Ethier et al power estimate using fixed study ln(HR)
power cox .2151114, n(235)
replace FixedPower = .3778 in 23

power cox .2151114, n(315)
replace FixedPower = .4796 in 24

power cox .2151114, n(407)
replace FixedPower = .5831 in 25

power cox .2151114, n(192)
replace FixedPower = .3193 in 26

power cox .2151114, n(2456)
replace FixedPower = .9996 in 27

power cox .2151114, n(605)
replace FixedPower = .7535 in 28

power cox .2151114, n(234)
replace FixedPower = .3765 in 29

power cox .2151114, n(875)
replace FixedPower = .8891 in 30

power cox .2151114, n(91)
replace FixedPower = .1752 in 31

power cox .2151114, n(95)
replace FixedPower = .1810 in 32

power cox .2151114, n(36)
replace FixedPower = .0943 in 33

power cox .2151114, n(320)
replace FixedPower = .4857 in 34

power cox .2151114, n(109)
replace FixedPower = .2013 in 35

power cox .2151114, n(1061)
replace FixedPower = .9386 in 36

power cox .2151114, n(282)
replace FixedPower = .4389 in 37

power cox .2151114, n(541)
replace FixedPower = .7060 in 38

power cox .2151114, n(344)
replace FixedPower = .5139 in 39

power cox .2151114, n(56)
replace FixedPower = .1240 in 40

power cox .2151114, n(32)
replace FixedPower = .0883 in 41

power cox .2151114, n(235)
replace FixedPower = .3778 in 42

power cox .2151114, n(508)
replace FixedPower = .6788 in 43

power cox .2151114, n(129)
replace FixedPower = .2301 in 44

power cox .2151114, n(143)
replace FixedPower = .2502 in 45

power cox .2151114, n(60)
replace FixedPower = .1299 in 46

power cox .2151114, n(519)
replace FixedPower = .6880 in 47

power cox .2151114, n(190)
replace FixedPower = .3165 in 48

power cox .2151114, n(460)
replace FixedPower = .6356 in 49

*Ethier et al power estimate using random study ln(HR)
power cox .5007753, n(235)
replace RandomPower = .9698 in 23

power cox .5007753, n(315)
replace RandomPower = .9935 in 24

power cox .5007753, n(407)
replace RandomPower = .9990 in 25

power cox .5007753, n(192)
replace RandomPower = .9344 in 26

power cox .5007753, n(2456)
replace RandomPower = 1.000 in 27

power cox .5007753, n(605)
replace RandomPower = 1.000 in 28

power cox .5007753, n(234)
replace RandomPower = .9693 in 29

power cox .5007753, n(875)
replace RandomPower = .8891 in 30

power cox .5007753, n(91)
replace RandomPower = 1.000 in 31

power cox .5007753, n(95)
replace RandomPower = .6846 in 32

power cox .5007753, n(36)
replace RandomPower = .3236 in 33

power cox .5007753, n(320)
replace RandomPower = .9941 in 34

power cox .5007753, n(109)
replace RandomPower = .7435 in 35

power cox .5007753, n(1061)
replace RandomPower = 1.000 in 36

power cox .5007753, n(282)
replace RandomPower = .9876 in 37

power cox .5007753, n(541)
replace RandomPower = .9999 in 38

power cox .5007753, n(344)
replace RandomPower = .9964 in 39

power cox .5007753, n(56)
replace RandomPower = .4656 in 40

power cox .5007753, n(32)
replace RandomPower = .2934 in 41

power cox .5007753, n(235)
replace RandomPower = .9698 in 42

power cox .5007753, n(508)
replace RandomPower = .9999 in 43

power cox .5007753, n(129)
replace RandomPower = .8116 in 44

power cox .5007753, n(143)
replace RandomPower = .8495 in 45

power cox .5007753, n(60)
replace RandomPower = .4918 in 46

power cox .5007753, n(519)
replace RandomPower = .9999 in 47

power cox .5007753, n(190)
replace RandomPower = .9321 in 48

power cox .5007753, n(460)
replace RandomPower = .9997 in 49

 
/////////////////////////////////////////////////
//											   //
//  			    Wu J et al.			       //
//				   Cervical OS				   //
//											   //
/////////////////////////////////////////////////

*Cervical et al power estimate using largest study ln(HR)
power cox .1739533, n(795)
replace LargestPower = .6888 in 50

power cox .1739533, n(95)
replace LargestPower = .1330 in 51

power cox .1739533, n(60)
replace LargestPower = .0992 in 52

power cox .1739533, n(235)
replace LargestPower = .2652 in 53

power cox .1739533, n(407)
replace LargestPower = .4187 in 54

power cox .1739533, n(75)
replace LargestPower = .1138 in 55

power cox .1739533, n(56)
replace LargestPower = .0953 in 56

power cox .1739533, n(76)
replace LargestPower = .1147 in 57

power cox .1739533, n(230)
replace LargestPower = .2608 in 58

power cox .1739533, n(460)
replace LargestPower = .4623 in 59

power cox .1739533, n(111)
replace LargestPower = .1483 in 60

power cox .1739533, n(1061)
replace LargestPower = .8087 in 61

*Cervical et al power estimate using fixed study ln(HR)
power cox .1906204, n(795)
replace FixedPower = .7665 in 50

power cox .1906204, n(95)
replace FixedPower = .1513 in 51

power cox .1906204, n(60)
replace FixedPower = .1109 in 52

power cox .1906204, n(235)
replace FixedPower = .3089 in 53

power cox .1906204, n(407)
replace FixedPower = .4852 in 54

power cox .1906204, n(75)
replace FixedPower = .1283 in 55

power cox .1906204, n(56)
replace FixedPower = .1062 in 56

power cox .1906204, n(76)
replace FixedPower = .1294 in 57

power cox .1906204, n(230)
replace FixedPower = .3034 in 58

power cox .1906204, n(460)
replace FixedPower = .5336 in 59

power cox .1906204, n(111)
replace FixedPower = .1696 in 60

power cox .1906204, n(1061)
replace FixedPower = .87838 in 61

*Cervical et al power estimate using random study ln(HR)
power cox .3148108, n(795)
replace RandomPower = .9934 in 50

power cox .3148108, n(95)
replace RandomPower = .3351 in 51

power cox .3148108, n(60)
replace RandomPower = .2294 in 52

power cox .3148108, n(235)
replace RandomPower = .6747 in 53

power cox .3148108, n(407)
replace RandomPower = .8879 in 54

power cox .3148108, n(75)
replace RandomPower = .2753 in 55

power cox .3148108, n(56)
replace RandomPower = .2171 in 56

power cox .3148108, n(76)
replace RandomPower = .2784 in 57

power cox .3148108, n(230)
replace RandomPower = .6654 in 58

power cox .3148108, n(460)
replace RandomPower = .9216 in 59

power cox .3148108, n(111)
replace RandomPower = .3815 in 60

power cox .3148108, n(1061)
replace RandomPower = .9992 in 61

 
/////////////////////////////////////////////////
//					       //
//  	            Wu J et al.		       //
//	           Cervical PFS		       //
//					       //
/////////////////////////////////////////////////

*Cervical et al power estimate using largest study ln(HR)
power cox .1222176, n(95)
replace LargestPower = .0862 in 62

power cox .1222176, n(60)
replace LargestPower = .0686 in 63

power cox .1222176, n(235)
replace LargestPower = .1531 in 64

power cox .1222176, n(56)
replace LargestPower = .0665 in 65

power cox .1222176, n(76)
replace LargestPower = .0768 in 66

power cox .1222176, n(230)
replace LargestPower = .1508 in 67

power cox .1222176, n(68)
replace LargestPower = .0727 in 68

power cox .1222176, n(460)
replace LargestPower = .2581 in 69

power cox .1222176, n(111)
replace LargestPower = .0941 in 70

power cox .1222176, n(1061)
replace LargestPower = .5122 in 71

*Cervical et al power estimate using fixed study ln(HR)
power cox .1739533, n(95)
replace FixedPower = .1330 in 62

power cox .1739533, n(60)
replace FixedPower = .0992 in 63

power cox .1739533, n(235)
replace FixedPower = .2654 in 64

power cox .1739533, n(56)
replace FixedPower = .0953 in 65

power cox .1739533, n(76)
replace FixedPower = .1147 in 66

power cox .1739533, n(230)
replace FixedPower = .2608 in 67

power cox .1739533, n(68)
replace FixedPower = .1070 in 68

power cox .1739533, n(460)
replace FixedPower = .4623 in 69

power cox .1739533, n(111)
replace FixedPower = .1483 in 70

power cox .1739533, n(1061)
replace FixedPower = .8087 in 71

*Cervical et al power estimate using random study ln(HR)
power cox .5423243, n(95)
replace RandomPower = .7527 in 62

power cox .5423243, n(60)
replace RandomPower = .5558 in 63

power cox .5423243, n(235)
replace RandomPower = .9860 in 64

power cox .5423243, n(56)
replace RandomPower = .5276 in 65

power cox .5423243, n(76)
replace RandomPower = .6569 in 66

power cox .5423243, n(230)
replace RandomPower = .9843 in 67

power cox .5423243, n(68)
replace RandomPower = .6088 in 68

power cox .5423243, n(460)
replace RandomPower = .9999 in 69

power cox .5423243, n(111)
replace RandomPower = .8151 in 70

power cox .5423243, n(1061)
replace RandomPower = 1.000 in 71


/////////////////////////////////////////////////
//					       //
//  		Huang QT et al.		       //
//		 Overian PFS		       //
//					       //
/////////////////////////////////////////////////

*Huang et al power estimate using largest study ln(HR)
power cox .2231435, n(128)
replace LargestPower = .2427 in 72

power cox .2231435, n(190)
replace LargestPower = .3365 in 73

power cox .2231435, n(126)
replace LargestPower = .2396 in 74

power cox .2231435, n(190)
replace LargestPower = .3365 in 75

power cox .2231435, n(143)
replace LargestPower = .2657 in 76

power cox .2231435, n(875)
replace LargestPower = .9099 in 77

power cox .2231435, n(334)
replace LargestPower = .5315 in 78

power cox .2231435, n(166)
replace LargestPower = .3007 in 79


*Huang et al power estimate using fixed study ln(HR)
power cox .3852624, n(128)
replace FixedPower = .5868 in 72

power cox .3852624, n(190)
replace FixedPower = .7566 in 73

power cox .3852624, n(126)
replace FixedPower = .5802 in 74

power cox .3852624, n(190)
replace FixedPower = .7566 in 75

power cox .3852624, n(143)
replace FixedPower = .6344 in 76

power cox .3852624, n(875)
replace FixedPower = .9999 in 77

power cox .3852624, n(334)
replace FixedPower = .9407 in 78

power cox .3852624, n(166)
replace FixedPower = .6991 in 79

*Huang et al power estimate using random study ln(HR)
power cox .48858, n(128)
replace RandomPower = .7893 in 72

power cox .48858, n(190)
replace RandomPower = .9203 in 73

power cox .48858, n(126)
replace RandomPower = .7829 in 74

power cox .48858, n(190)
replace RandomPower = .9203 in 75

power cox .48858, n(143)
replace RandomPower = .8318 in 76

power cox .48858, n(875)
replace RandomPower = 1.000 in 77

power cox .48858, n(334)
replace RandomPower = .9939 in 78

power cox .48858, n(166)
replace RandomPower = .8825 in 79


export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Gyn.xlsx"


**power of individual studies in gastrointestinal cancers

clear
 
import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("Gastrointestinal") firstrow
 
gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)
 
/////////////////////////////////////////////////
//					       //
//  		   Sun J et al.		       //
//		   Gastric DFS		       //
//					       //
/////////////////////////////////////////////////

*Sun et al power estimate using largest study ln(HR)
power cox .5007753, n(102)
replace LargestPower = .7153 in 1

power cox .5007753, n(268)
replace LargestPower = .9838 in 2

power cox .5007753, n(70)
replace LargestPower = .5537 in 3

power cox .5007753, n(104)
replace LargestPower = .7236 in 4

power cox .5007753, n(46)
replace LargestPower = .3968 in 5

power cox .5007753, n(293)
replace LargestPower = .9900 in 6

power cox .5007753, n(93)
replace LargestPower = .6753 in 7

*Sun et al power estimate using fixed study ln(HR)
power cox .4574248, n(102)
replace FixedPower = .6368 in 1

power cox .4574248, n(268)
replace FixedPower = .9628 in 2

power cox .4574248, n(70)
replace FixedPower = .4815 in 3

power cox .4574248, n(104)
replace FixedPower = .6452 in 4

power cox .4574248, n(46)
replace FixedPower = .3414 in 5

power cox .4574248, n(293)
replace FixedPower = .9747 in 6

power cox .4574248, n(93)
replace FixedPower = .5970 in 7

*Sun et al power estimate using random study ln(HR)
power cox .4574248, n(102)
replace RandomPower = .6368 in 1

power cox .4574248, n(268)
replace RandomPower = .9628 in 2

power cox .4574248, n(70)
replace RandomPower = .4815 in 3

power cox .4574248, n(104)
replace RandomPower = .6452 in 4

power cox .4574248, n(46)
replace RandomPower = .3414 in 5

power cox .4574248, n(293)
replace RandomPower = .9747 in 6

power cox .4574248, n(93)
replace RandomPower = .5970 in 7


/////////////////////////////////////////////////
//					       //
//  	           Sun J et al.		       //
//		   Gastric OS		       //
//					       //
/////////////////////////////////////////////////

*Sun et al power estimate using largest study ln(HR)
power cox .4187103, n(102)
replace LargestPower = .5614 in 8

power cox .4187103, n(268)
replace LargestPower = .9289 in 9

power cox .4187103, n(236)
replace LargestPower = .8955 in 10

power cox .4187103, n(70)
replace LargestPower = .4175 in 11

power cox .4187103, n(156)
replace LargestPower = .7437 in 12

power cox .4187103, n(104)
replace LargestPower = .5695 in 13

power cox .4187103, n(377)
replace LargestPower = .9824 in 14

power cox .4187103, n(46)
replace LargestPower = .2946 in 15

power cox .4187103, n(293)
replace LargestPower = .9478 in 16

power cox .4187103, n(93)
replace LargestPower = .5235 in 17

power cox .4187103, n(83)
replace LargestPower = .4790 in 18

power cox .4187103, n(220)
replace LargestPower = .8740 in 19

power cox .4187103, n(174)
replace LargestPower = .7886 in 20

power cox .4187103, n(357)
replace LargestPower = .9770 in 21

power cox .4187103, n(123)
replace LargestPower = .6413 in 22

power cox .4187103, n(1028)
replace LargestPower = 1.000 in 23

power cox .4187103, n(157)
replace LargestPower = .7464 in 24

power cox .4187103, n(324)
replace LargestPower = .9647 in 25

power cox .4187103, n(1220)
replace LargestPower = 1.000 in 26

*Sun et al power estimate using fixed study ln(HR)
power cox .6830968, n(102)
replace FixedPower = .9318 in 8

power cox .6830968, n(268)
replace FixedPower = .9999 in 9

power cox .6830968, n(236)
replace FixedPower = .9995 in 10

power cox .6830968, n(70)
replace FixedPower = .8153 in 11

power cox .6830968, n(156)
replace FixedPower = .9894 in 12

power cox .6830968, n(104)
replace FixedPower = .9361 in 13

power cox .6830968, n(377)
replace FixedPower = 1.000 in 14

power cox .6830968, n(46)
replace FixedPower = .6393 in 15

power cox .6830968, n(293)
replace FixedPower = .9999 in 16

power cox .6830968, n(93)
replace FixedPower = .9089 in 17

power cox .6830968, n(83)
replace FixedPower = .8753 in 18

power cox .6830968, n(220)
replace FixedPower = .9991 in 19

power cox .6830968, n(174)
replace FixedPower = .9945 in 20

power cox .6830968, n(357)
replace FixedPower = 1.000 in 21

power cox .6830968, n(123)
replace FixedPower = .9662 in 22

power cox .6830968, n(1028)
replace FixedPower = 1.000 in 23

power cox .6830968, n(157)
replace FixedPower = .9898 in 24

power cox .6830968, n(324)
replace FixedPower = 1.000 in 25

power cox .6830968, n(1220)
replace FixedPower = 1.000 in 26

*Sun et al power estimate using random study ln(HR)
power cox .6830968, n(102)
replace RandomPower = .9318 in 8

power cox .6830968, n(268)
replace RandomPower = .9999 in 9

power cox .6830968, n(236)
replace RandomPower = .9995 in 10

power cox .6830968, n(70)
replace RandomPower = .8153 in 11

power cox .6830968, n(156)
replace RandomPower = .9894 in 12

power cox .6830968, n(104)
replace RandomPower = .9361 in 13

power cox .6830968, n(377)
replace RandomPower = 1.000 in 14

power cox .6830968, n(46)
replace RandomPower = .6393 in 15

power cox .6830968, n(293)
replace RandomPower = .9999 in 16

power cox .6830968, n(93)
replace RandomPower = .9089 in 17

power cox .6830968, n(83)
replace RandomPower = .8753 in 18

power cox .6830968, n(220)
replace RandomPower = .9991 in 19

power cox .6830968, n(174)
replace RandomPower = .9945 in 20

power cox .6830968, n(357)
replace RandomPower = 1.000 in 21

power cox .6830968, n(123)
replace RandomPower = .9662 in 22

power cox .6830968, n(1028)
replace RandomPower = 1.000 in 23

power cox .6830968, n(157)
replace RandomPower = .9898 in 24

power cox .6830968, n(324)
replace RandomPower = 1.000 in 25

power cox .6830968, n(1220)
replace RandomPower = 1.000 in 26


/////////////////////////////////////////////////
//					       //
//  	          Zhang et al.		       //
//		  Gastric PFS		       //
//					       //
/////////////////////////////////////////////////

*Zhang et al power estimate using largest study ln(HR)
power cox .3920421, n(46)
replace LargestPower = .2642 in 27

power cox .3920421, n(268)
replace LargestPower = .8942 in 28

*Zhang et al power estimate using fixed study ln(HR)
power cox .4317824, n(46)
replace FixedPower = .3100 in 27

power cox .4317824, n(268)
replace FixedPower = .9423 in 28

*Zhang et al power estimate using random study ln(HR)
power cox .463734, n(46)
replace RandomPower = .3492 in 27

power cox .463734, n(268)
replace RandomPower = .9668 in 28

/////////////////////////////////////////////////
//					       //
//  		 Shen et al.		       //
//	       Gastric Intra OS		       //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)
power cox .662688, n(323)
replace LargestPower = 1.000 in 29

power cox .662688, n(273)
replace LargestPower = .9998 in 30

*Shen et al power estimate using fixed study ln(HR)
power cox .009503, n(323)
replace FixedPower = .0304 in 29

power cox .009503, n(273)
replace FixedPower = .0300 in 30

*Shen et al power estimate using random study ln(HR)
power cox .1823216, n(323)
replace RandomPower = .3739 in 29

power cox .1823216, n(273)
replace RandomPower = .3250 in 30

/////////////////////////////////////////////////
//					       //
//  	      Paramanathan A et al.            //
//	         Gastric SR OS		       //
//					       //
/////////////////////////////////////////////////

*Paramanthan et al power estimate using largest study ln(HR)
power cox .6097656, n(120)
replace LargestPower = 0.9162 in 31

power cox .6097656, n(55)
replace LargestPower = 0.6183 in 32

power cox .6097656, n(293)
replace LargestPower = 0.9994 in 33

power cox .6097656, n(357)
replace LargestPower = 0.9999 in 34

power cox .6097656, n(1028)
replace LargestPower = 1.000 in 35

power cox .6097656, n(157)
replace LargestPower = 0.9686 in 36

power cox .6097656, n(324)
replace LargestPower = 0.9998 in 37

*Paramanthan et al power estimate using fixed study ln(HR)
power cox .5877867, n(120)
replace FixedPower = 0.8961 in 31

power cox .5877867, n(55)
replace FixedPower = 0.5869 in 32

power cox .5877867, n(293)
replace FixedPower = 0.9989 in 33

power cox .5877867, n(357)
replace FixedPower = 0.9998 in 34

power cox .5877867, n(1028)
replace FixedPower = 1.000 in 35

power cox .5877867, n(157)
replace FixedPower = 0.9575 in 36

power cox .5877867, n(324)
replace FixedPower = 0.9996 in 37

*Paramanthan et al power estimate using random study ln(HR)
power cox .6780335, n(120)
replace RandomPower = 0.9603 in 31

power cox .6780335, n(55)
replace RandomPower = 0.7103 in 32

power cox .6780335, n(293)
replace RandomPower = 0.9999 in 33

power cox .6780335, n(357)
replace RandomPower = 1.000 in 34

power cox .6780335, n(1028)
replace RandomPower = 1.000 in 35

power cox .6780335, n(157)
replace RandomPower = 0.9889 in 36

power cox .6780335, n(324)
replace RandomPower = 1.000 in 37


/////////////////////////////////////////////////
//					       //
//  	    	   Tang H et al.	       //
//		       BT OS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox .1310283, n(85)
replace LargestPower = 0.0876 in 38

power cox .1310283, n(322)
replace LargestPower = 0.2164 in 39

power cox .1310283, n(145)
replace LargestPower = 0.1208 in 40

power cox .1310283, n(96)
replace LargestPower = 0.0937 in 41

power cox .1310283, n(90)
replace LargestPower = 0.0904 in 42

power cox .1310283, n(534)
replace LargestPower = 0.3278 in 43

power cox .1310283, n(127)
replace LargestPower = 0.1109 in 44

power cox .1310283, n(864)
replace LargestPower = 0.4863 in 45

power cox .1310283, n(221)
replace LargestPower = 0.1621 in 46

power cox .1310283, n(102)
replace LargestPower = 0.0971 in 47

power cox .1310283, n(52)
replace LargestPower = 0.0684 in 48

power cox .1310283, n(90)
replace LargestPower = 0.0904 in 49

power cox .1310283, n(462)
replace LargestPower = 0.2905 in 50

power cox .1310283, n(27)
replace LargestPower = 0.0527 in 51


*Tang et al power estimate using fixed study ln(HR)
power cox .3987761, n(85)
replace FixedPower = 0.4516 in 38

power cox .3987761, n(322)
replace FixedPower = 0.9472 in 39

power cox .3987761, n(145)
replace FixedPower = 0.6704 in 40

power cox .3987761, n(96)
replace FixedPower = 0.4975 in 41

power cox .3987761, n(90)
replace FixedPower = 0.4727 in 42

power cox .3987761, n(534)
replace FixedPower = 0.9959 in 43

power cox .3987761, n(127)
replace FixedPower = 0.6130 in 44

power cox .3987761, n(864)
replace FixedPower = 1.000 in 45

power cox .3987761, n(221)
replace FixedPower = 0.8423 in 46

power cox .3987761, n(102)
replace FixedPower = 0.5214 in 47

power cox .3987761, n(52)
replace FixedPower = 0.3008 in 48

power cox .3987761, n(90)
replace FixedPower = 0.4727 in 49

power cox .3987761, n(462)
replace FixedPower = 0.9900 in 50

power cox .3987761, n(27)
replace FixedPower = 0.1778 in 51


*Tang et al power estimate using random study ln(HR)
power cox .4121096, n(85)
replace RandomPower = 0.4760 in 38

power cox .4121096, n(322)
replace RandomPower = 0.9589 in 39

power cox .4121096, n(145)
replace RandomPower = 0.6989 in 40

power cox .4121096, n(96)
replace RandomPower = 0.5235 in 41

power cox .4121096, n(90)
replace RandomPower = 0.4979 in 42

power cox .4121096, n(534)
replace RandomPower = 0.9975 in 43

power cox .4121096, n(127)
replace RandomPower = 0.6414 in 44

power cox .4121096, n(864)
replace RandomPower = 1.000 in 45

power cox .4121096, n(221)
replace RandomPower = 0.8650 in 46

power cox .4121096, n(102)
replace RandomPower = 0.5482 in 47

power cox .4121096, n(52)
replace RandomPower = 0.3177 in 48

power cox .4121096, n(90)
replace RandomPower = 0.4979 in 49

power cox .4121096, n(462)
replace RandomPower = 0.9932 in 50

power cox .4121096, n(27)
replace RandomPower = 0.1869 in 51
 
/////////////////////////////////////////////////
//					       //
//  	    	   Tang H et al.	       //
//		      BT RFS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox .2231435, n(102)
replace LargestPower = 0.2024 in 52

power cox .2231435, n(322)
replace LargestPower = 0.5168 in 53

power cox .2231435, n(90)
replace LargestPower = 0.1837 in 54

power cox .2231435, n(27)
replace LargestPower = 0.0838 in 55

power cox .2231435, n(96)
replace LargestPower = 0.1930 in 56

*Tang et al power estimate using fixed study ln(HR)
power cox .3293037, n(102)
replace FixedPower = 0.3832 in 52

power cox .3293037, n(322)
replace FixedPower = 0.8400 in 53

power cox .3293037, n(90)
replace FixedPower = 0.3453 in 54

power cox .3293037, n(27)
replace FixedPower = 0.1347 in 55

power cox .3293037, n(96)
replace FixedPower = 0.3644 in 56

*Tang et al power estimate using random study ln(HR)
power cox .3784364, n(102)
replace RandomPower = 0.4805 in 52

power cox .3784364, n(322)
replace RandomPower = 0.9244 in 53

power cox .3784364, n(90)
replace RandomPower = 0.4345 in 54

power cox .3784364, n(27)
replace RandomPower = 0.1643 in 55

power cox .3784364, n(96)
replace RandomPower = 0.4578 in 56

 
/////////////////////////////////////////////////
//					       //
//  	    	   Cheng H et al.	       //
//	           Pancreatic OS	       //
//					       //
/////////////////////////////////////////////////

*Cheng et al power estimate using largest study ln(HR)
power cox .3393253, n(252)
replace LargestPower = 0.7683 in 57

power cox .3393253, n(177)
replace LargestPower = 0.6169 in 58

power cox .3393253, n(403)
replace LargestPower = 0.9259 in 59

power cox .3393253, n(124)
replace LargestPower = 0.4718 in 60

power cox .3393253, n(89)
replace LargestPower = 0.3597 in 61

power cox .3393253, n(84)
replace LargestPower = 0.3427 in 62

power cox .3393253, n(85)
replace LargestPower = 0.3461 in 63

power cox .3393253, n(381)
replace LargestPower = 0.9118 in 64

power cox .3393253, n(440)
replace LargestPower = 0.9451 in 65

*Cheng et al power estimate using fixed study ln(HR)
power cox .4574248, n(252)
replace FixedPower = 0.9526 in 57

power cox .4574248, n(177)
replace FixedPower = 0.8606 in 58

power cox .4574248, n(403)
replace FixedPower = 0.9957 in 59

power cox .4574248, n(124)
replace FixedPower = 0.7214 in 60

power cox .4574248, n(89)
replace FixedPower = 0.5784 in 61

power cox .4574248, n(84)
replace FixedPower = 0.5542 in 62

power cox .4574248, n(85)
replace FixedPower = 0.5591 in 63

power cox .4574248, n(381)
replace FixedPower = 0.9939 in 64

power cox .4574248, n(440)
replace FixedPower = 0.9977 in 65

*Cheng et al power estimate using random study ln(HR)
power cox .5007753, n(252)
replace RandomPower = 0.9780 in 57

power cox .5007753, n(177)
replace RandomPower = 0.9148 in 58

power cox .5007753, n(403)
replace RandomPower = 0.9989 in 59

power cox .5007753, n(124)
replace RandomPower = 0.7962 in 60

power cox .5007753, n(89)
replace RandomPower = 0.6562 in 61

power cox .5007753, n(84)
replace RandomPower = 0.6311 in 62

power cox .5007753, n(85)
replace RandomPower = 0.6363 in 63

power cox .5007753, n(381)
replace RandomPower = 0.9983 in 64

power cox .5007753, n(440)
replace RandomPower = 0.9995 in 65


/////////////////////////////////////////////////
//					       //
//  	    	   Yang JJ et al.	       //
//	           Pancreatic CSS	       //
//					       //
/////////////////////////////////////////////////

*Yang et al power estimate using largest study ln(HR)
power cox .2151114, n(203)
replace LargestPower = 0.3345 in 66

power cox .2151114, n(182)
replace LargestPower = 0.3054 in 67

power cox .2151114, n(73)
replace LargestPower = 0.1489 in 68

*Yang et al power estimate using fixed study ln(HR)
power cox .3576744, n(203)
replace FixedPower = 0.7218 in 66

power cox .3576744, n(182)
replace FixedPower = 0.6746 in 67

power cox .3576744, n(73)
replace FixedPower = 0.3329 in 68

*Yang et al power estimate using random study ln(HR)
power cox .5068176, n(203)
replace RandomPower = 0.9506 in 66

power cox .5068176, n(182)
replace RandomPower = 0.9277 in 67

power cox .5068176, n(73)
replace RandomPower = 0.5813 in 68


/////////////////////////////////////////////////
//					       //
//  	    	   Dong YW et al.	       //
//	             Rectal DFS	               //
//					       //
/////////////////////////////////////////////////

*Dong et al power estimate using largest study ln(HR)
power cox 1.363537, n(199)
replace LargestPower = 1.000 in 69

power cox 1.363537, n(89)
replace LargestPower = 1.000 in 70

power cox 1.363537, n(115)
replace LargestPower = 1.000 in 71

*Dong et al power estimate using fixed study ln(HR)
power cox 1.451614, n(199)
replace FixedPower = 1.000 in 69

power cox 1.451614, n(89)
replace FixedPower = 1.000 in 70

power cox 1.451614, n(115)
replace FixedPower = 1.000 in 71

*Dong et al power estimate using random study ln(HR)
power cox 1.451614, n(199)
replace RandomPower = 1.000 in 69

power cox 1.451614, n(89)
replace RandomPower = 1.000 in 70

power cox 1.451614, n(115)
replace RandomPower = 1.000 in 71


/////////////////////////////////////////////////
//					       //
//  	    	   Dong YW et al.	       //
//		     Rectal OS		       //
//					       //
/////////////////////////////////////////////////

*Dong et al power estimate using largest study ln(HR)
power cox 3.380995, n(199)
replace LargestPower = 1.000 in 72

power cox 3.380995, n(89)
replace LargestPower = 1.000 in 73

power cox 3.380995, n(115)
replace LargestPower = 1.000 in 74

power cox 3.380995, n(201)
replace LargestPower = 1.000 in 75

power cox 3.380995, n(123)
replace LargestPower = 1.000 in 76

power cox 3.380995, n(130)
replace LargestPower = 1.000 in 77

*Dong et al power estimate using fixed study ln(HR)
power cox 2.639057, n(199)
replace FixedPower = 1.000 in 72

power cox 2.639057, n(89)
replace FixedPower = 1.000 in 73

power cox 2.639057, n(115)
replace FixedPower = 1.000 in 74

power cox 2.639057, n(201)
replace FixedPower = 1.000 in 75

power cox 2.639057, n(123)
replace FixedPower = 1.000 in 76

power cox 2.639057, n(130)
replace FixedPower = 1.000 in 77

*Dong et al power estimate using random study ln(HR)
power cox 2.639057, n(199)
replace RandomPower = 1.000 in 72

power cox 2.639057, n(89)
replace RandomPower = 1.000 in 73

power cox 2.639057, n(115)
replace RandomPower = 1.000 in 74

power cox 2.639057, n(201)
replace RandomPower = 1.000 in 75

power cox 2.639057, n(123)
replace RandomPower = 1.000 in 76

power cox 2.639057, n(130)
replace RandomPower = 1.000 in 77


/////////////////////////////////////////////////
//					       //
//  	    	   Dong YW et al.	       //
//		     Rectal RFS		       //
//					       //
/////////////////////////////////////////////////

*Dong et al power estimate using largest study ln(HR)
power cox 1.071584, n(201)
replace LargestPower = 1.000 in 78

power cox 1.071584, n(102)
replace LargestPower = 1.000 in 79

power cox 1.071584, n(130)
replace LargestPower = 1.000 in 80

*Dong et al power estimate using fixed study ln(HR)
power cox 1.280934, n(201)
replace FixedPower = 1.000 in 78

power cox 1.280934, n(102)
replace FixedPower = 1.000 in 79

power cox 1.280934, n(130)
replace FixedPower = 1.000 in 80

*Dong et al power estimate using random study ln(HR)
power cox 1.280934, n(201)
replace RandomPower = 1.000 in 78

power cox 1.280934, n(102)
replace RandomPower = 1.000 in 79

power cox 1.280934, n(130)
replace RandomPower = 1.000 in 80


/////////////////////////////////////////////////
//					       //
//  	           Huang Y et al.	       //
//	          Oesophageal PFS	       //
//					       //
/////////////////////////////////////////////////

*Dong et al power estimate using largest study ln(HR)
power cox 0.1629688, n(41)
replace LargestPower = 0.0752 in 81

power cox 0.1629688, n(212)
replace LargestPower = 0.2196 in 82

*Dong et al power estimate using fixed study ln(HR)
power cox 0.1988509, n(41)
replace FixedPower = 0.0929 in 81

power cox 0.1988509, n(212)
replace FixedPower = 0.3042 in 82

*Dong et al power estimate using random study ln(HR)
power cox 0.1988509, n(41)
replace RandomPower = 0.0929 in 81

power cox 0.1988509, n(212)
replace RandomPower = 0.3042 in 82


/////////////////////////////////////////////////
//					       //
//  	           Zhang J et al.	       //
//		   Colorectal DFS	       //
//					       //
/////////////////////////////////////////////////

*Zhang et al power estimate using largest study ln(HR)
power cox 0.2151114, n(115)
replace LargestPower = 0.2100 in 83

power cox 0.2151114, n(1040)
replace LargestPower = 0.9343 in 84

power cox 0.2151114, n(174)
replace LargestPower = 0.2942 in 85

power cox 0.2151114, n(624)
replace LargestPower = 0.7663 in 86

power cox 0.2151114, n(225)
replace LargestPower = 0.3644 in 87

*Zhang et al power estimate using fixed study ln(HR)
power cox 0.5068176, n(115)
replace FixedPower = 0.7756 in 83

power cox 0.5068176, n(1040)
replace FixedPower = 1.000 in 84

power cox 0.5068176, n(174)
replace FixedPower = 0.9166 in 85

power cox 0.5068176, n(624)
replace FixedPower = 1.000 in 86

power cox 0.5068176, n(225)
replace FixedPower = 0.9672 in 87

*Zhang et al power estimate using random study ln(HR)
power cox 0.5538851, n(115)
replace RandomPower = 0.8437 in 83

power cox 0.5538851, n(1040)
replace RandomPower = 1.000 in 84

power cox 0.5538851, n(174)
replace RandomPower = 0.9548 in 85

power cox 0.5538851, n(624)
replace RandomPower = 1.000 in 86

power cox 0.5538851, n(225)
replace RandomPower = 0.9859 in 87


/////////////////////////////////////////////////
//					       //
//  	           Zheng DC et al.	       //
//		    Colorectal OS	       //
//					       //
/////////////////////////////////////////////////

*Zheng et al power estimate using largest study ln(HR)
power cox 0.2700271, n(149)
replace LargestPower = 0.3776 in 88

power cox 0.2700271, n(84)
replace LargestPower = 0.2350 in 89

power cox 0.2700271, n(440)
replace LargestPower = 0.8084 in 90

power cox 0.2700271, n(200)
replace LargestPower = 0.4798 in 91

power cox 0.2700271, n(90)
replace LargestPower = 0.2485 in 92

power cox 0.2700271, n(123)
replace LargestPower = 0.3218 in 93

power cox 0.2700271, n(171)
replace LargestPower = 0.4229 in 94

power cox 0.2700271, n(171)
replace LargestPower = 0.4229 in 95

power cox 0.2700271, n(92)
replace LargestPower = 0.2530 in 96

power cox 0.2700271, n(115)
replace LargestPower = 0.3043 in 97

power cox 0.2700271, n(1943)
replace LargestPower = 1.000 in 98

power cox 0.2700271, n(1788)
replace LargestPower = 0.9999 in 99

power cox 0.2700271, n(50)
replace LargestPower = 0.1574 in 100

power cox 0.2700271, n(200)
replace LargestPower = 0.4798 in 101

power cox 0.2700271, n(206)
replace LargestPower = 0.4912 in 102

power cox 0.2700271, n(243)
replace LargestPower = 0.5575 in 103

power cox 0.2700271, n(624)
replace LargestPower = 0.9211 in 104

power cox 0.2700271, n(504)
replace LargestPower = 0.8579 in 105

power cox 0.2700271, n(50)
replace LargestPower = 0.1574 in 106

power cox 0.2700271, n(84)
replace LargestPower = 0.2350 in 107

power cox 0.2700271, n(600)
replace LargestPower = 0.9110 in 108

*Zheng et al power estimate using fixed study ln(HR)
power cox 0.463734, n(149)
replace FixedPower = 0.8079 in 88

power cox 0.463734, n(84)
replace FixedPower = 0.5656 in 89

power cox 0.463734, n(440)
replace FixedPower = 0.9982 in 90

power cox 0.463734, n(200)
replace FixedPower = 0.9064 in 91

power cox 0.463734, n(90)
replace FixedPower = 0.5947 in 92

power cox 0.463734, n(123)
replace FixedPower = 0.7296 in 93

power cox 0.463734, n(171)
replace FixedPower = 0.8582 in 94

power cox 0.463734, n(171)
replace FixedPower = 0.8582 in 95

power cox 0.463734, n(92)
replace FixedPower = 0.6041 in 96

power cox 0.463734, n(115)
replace FixedPower = 0.7007 in 97

power cox 0.463734, n(1943)
replace FixedPower = 1.000 in 98

power cox 0.463734, n(1788)
replace FixedPower = 1.000 in 99

power cox 0.463734, n(50)
replace FixedPower = 0.3743 in 100

power cox 0.463734, n(200)
replace FixedPower = 0.9064 in 101

power cox 0.463734, n(206)
replace FixedPower = 0.9143 in 102

power cox 0.463734, n(243)
replace FixedPower = 0.9510 in 103

power cox 0.463734, n(624)
replace FixedPower = 0.9999 in 104

power cox 0.463734, n(504)
replace FixedPower = 0.9994 in 105

power cox 0.463734, n(50)
replace FixedPower = 0.3743 in 106

power cox 0.463734, n(84)
replace FixedPower = 0.5656 in 107

power cox 0.463734, n(600)
replace FixedPower = 0.9999 in 108

*Zheng et al power estimate using random study ln(HR)
power cox 0.6471033, n(149)
replace RandomPower = 0.9767 in 88

power cox 0.6471033, n(84)
replace RandomPower = 0.8427 in 89

power cox 0.6471033, n(440)
replace RandomPower = 1.000 in 90

power cox 0.6471033, n(200)
replace RandomPower = 0.9955 in 91

power cox 0.6471033, n(90)
replace RandomPower = 0.8664 in 92

power cox 0.6471033, n(123)
replace RandomPower = 0.9483 in 93

power cox 0.6471033, n(171)
replace RandomPower = 0.9884 in 94

power cox 0.6471033, n(171)
replace RandomPower = 0.9884 in 95

power cox 0.6471033, n(92)
replace RandomPower = 0.8736 in 96

power cox 0.6471033, n(115)
replace RandomPower = 0.9344 in 97

power cox 0.6471033, n(1943)
replace RandomPower = 1.000 in 98

power cox 0.6471033, n(1788)
replace RandomPower = 1.000 in 99

power cox 0.6471033, n(50)
replace RandomPower = 0.6285 in 100

power cox 0.6471033, n(200)
replace RandomPower = 0.9955 in 101

power cox 0.6471033, n(206)
replace RandomPower = 0.9964 in 102

power cox 0.6471033, n(243)
replace RandomPower = 0.9990 in 103

power cox 0.6471033, n(624)
replace RandomPower = 1.000 in 104

power cox 0.6471033, n(504)
replace RandomPower = 1.000 in 105

power cox 0.6471033, n(50)
replace RandomPower = 0.6285 in 106

power cox 0.6471033, n(84)
replace RandomPower = 0.8427 in 107

power cox 0.6471033, n(600)
replace RandomPower = 1.000 in 108


/////////////////////////////////////////////////
//					       //
//  	           Zheng DC et al.	       //
//		    Colorectal PFS	       //
//					       //
/////////////////////////////////////////////////

*Zheng et al power estimate using largest study ln(HR)
power cox 0.6678294, n(440)
replace LargestPower = 1.000 in 109

power cox 0.6678294, n(141)
replace LargestPower = 0.9775 in 110

power cox 0.6678294, n(171)
replace LargestPower = 0.9919 in 111

power cox 0.6678294, n(171)
replace LargestPower = 0.9919 in 112

power cox 0.6678294, n(92)
replace LargestPower = 0.8930 in 113

power cox 0.6678294, n(115)
replace LargestPower = 0.9475 in 114

power cox 0.6678294, n(297)
replace LargestPower = 0.9999 in 115

power cox 0.6678294, n(50)
replace LargestPower = 0.6559 in 116

power cox 0.6678294, n(243)
replace LargestPower = 0.9994 in 117

power cox 0.6678294, n(130)
replace LargestPower = 0.9676 in 118

power cox 0.6678294, n(624)
replace LargestPower = 1.000 in 119

power cox 0.6678294, n(84)
replace LargestPower = 0.8644 in 120

power cox 0.6678294, n(504)
replace LargestPower = 1.000 in 121

power cox 0.6678294, n(600)
replace LargestPower = 1.000 in 122

*Zheng et al power estimate using fixed study ln(HR)
power cox 0.5364934, n(440)
replace FixedPower = 0.9999 in 109

power cox 0.5364934, n(141)
replace FixedPower = 0.8898 in 110

power cox 0.5364934, n(171)
replace FixedPower = 0.9392 in 111

power cox 0.5364934, n(171)
replace FixedPower = 0.9392 in 112

power cox 0.5364934, n(92)
replace FixedPower = 0.7301 in 113

power cox 0.5364934, n(115)
replace FixedPower = 0.8203 in 114

power cox 0.5364934, n(297)
replace FixedPower = 0.9961 in 115

power cox 0.5364934, n(50)
replace FixedPower = 0.4748 in 116

power cox 0.5364934, n(243)
replace FixedPower = 0.9869 in 117

power cox 0.5364934, n(130)
replace FixedPower = 0.8640 in 118

power cox 0.5364934, n(624)
replace FixedPower = 1.000 in 119

power cox 0.5364934, n(84)
replace FixedPower = 0.6910 in 120

power cox 0.5364934, n(504)
replace FixedPower = 1.000 in 121

power cox 0.5364934, n(600)
replace FixedPower = 1.000 in 122

*Zheng et al power estimate using random study ln(HR)
power cox 0.6365768, n(440)
replace RandomPower = 1.0000 in 109

power cox 0.6365768, n(141)
replace RandomPower = 0.9656 in 110

power cox 0.6365768, n(171)
replace RandomPower = 0.9862 in 111

power cox 0.6365768, n(171)
replace RandomPower = 0.9862 in 112

power cox 0.6365768, n(92)
replace RandomPower = 0.8628 in 113

power cox 0.9269, n(115)
replace RandomPower = 0.8203 in 114

power cox 0.6365768, n(297)
replace RandomPower = 0.9998 in 115

power cox 0.6365768, n(50)
replace RandomPower = 0.6144 in 116

power cox 0.6365768, n(243)
replace RandomPower = 0.9987 in 117

power cox 0.6365768, n(130)
replace RandomPower = 0.9524 in 118

power cox 0.6365768, n(624)
replace RandomPower = 1.000 in 119

power cox 0.6365768, n(84)
replace RandomPower = 0.8308 in 120

power cox 0.6365768, n(504)
replace RandomPower = 1.000 in 121

power cox 0.6365768, n(600)
replace RandomPower = 1.000 in 122


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//		      CLM OS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.8241754, n(169)
replace LargestPower = 0.9997 in 123

power cox 0.8241754, n(440)
replace LargestPower = 1.000 in 124

power cox 0.8241754, n(290)
replace LargestPower = 1.000 in 125

power cox 0.8241754, n(359)
replace LargestPower = 1.000 in 126

power cox 0.8241754, n(92)
replace LargestPower = 0.9768 in 127

power cox 0.8241754, n(198)
replace LargestPower = 0.9999 in 128

power cox 0.8241754, n(302)
replace LargestPower = 1.000 in 129

*Tang et al power estimate using fixed study ln(HR)
power cox 0.7747272, n(169)
replace FixedPower = 0.9990 in 123

power cox 0.7747272, n(440)
replace FixedPower = 1.000 in 124

power cox 0.7747272, n(290)
replace FixedPower = 1.000 in 125

power cox 0.7747272, n(359)
replace FixedPower = 1.000 in 126

power cox 0.7747272, n(92)
replace FixedPower = 0.9604 in 127

power cox 0.7747272, n(198)
replace FixedPower = 0.9998 in 128

power cox 0.7747272, n(302)
replace FixedPower = 1.000 in 129

*Tang et al power estimate using random study ln(HR)
power cox 0.7747272, n(169)
replace RandomPower = 0.9990 in 123

power cox 0.7747272, n(440)
replace RandomPower = 1.000 in 124

power cox 0.7747272, n(290)
replace RandomPower = 1.000 in 125

power cox 0.7747272, n(359)
replace RandomPower = 1.000 in 126

power cox 0.7747272, n(92)
replace RandomPower = 0.9604 in 127

power cox 0.7747272, n(198)
replace RandomPower = 0.9998 in 128

power cox 0.7747272, n(302)
replace RandomPower = 1.000 in 129


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//		     CLM RFS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.7929925, n(98)
replace LargestPower = 0.9753 in 130

power cox 0.7929925, n(61)
replace LargestPower = 0.8722 in 131

power cox 0.7929925, n(198)
replace LargestPower = 0.9999 in 132

power cox 0.7929925, n(440)
replace LargestPower = 1.0000 in 133

power cox 0.7929925, n(130)
replace LargestPower = 0.9948 in 134

power cox 0.7929925, n(92)
replace LargestPower = 0.9673 in 135

*Tang et al power estimate using fixed study ln(HR)
power cox 0.6729445, n(98)
replace FixedPower = 0.9148 in 130

power cox 0.6729445, n(61)
replace FixedPower = 0.7479 in 131

power cox 0.6729445, n(198)
replace FixedPower = 0.9972 in 132

power cox 0.6729445, n(440)
replace FixedPower = 1.0000 in 133

power cox 0.6729445, n(130)
replace FixedPower = 0.9697 in 134

power cox 0.6729445, n(92)
replace FixedPower = 0.8975 in 135

*Tang et al power estimate using random study ln(HR)
power cox 0.6729445, n(98)
replace RandomPower = 0.9148 in 130

power cox 0.6729445, n(61)
replace RandomPower = 0.7479 in 131

power cox 0.6729445, n(198)
replace RandomPower = 0.9972 in 132

power cox 0.6729445, n(440)
replace RandomPower = 1.0000 in 133

power cox 0.6729445, n(130)
replace RandomPower = 0.9697 in 134

power cox 0.6729445, n(92)
replace RandomPower = 0.8975 in 135


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//	             CLM NS OS		       //
//			                       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 1.064711, n(359)
replace LargestPower = 1.0000 in 136

power cox 1.064711, n(92)
replace LargestPower = 0.9992 in 137

*Tang et al power estimate using fixed study ln(HR)
power cox 1.134623, n(359)
replace FixedPower = 1.0000 in 136

power cox 1.134623, n(92)
replace FixedPower = 0.9998 in 137

*Tang et al power estimate using random study ln(HR)
power cox 1.134623, n(359)
replace RandomPower = 1.0000 in 136

power cox 1.134623, n(92)
replace RandomPower = 0.9998 in 137


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//	             CLM SR OS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.8241754, n(169)
replace LargestPower = 0.9997 in 138

power cox 0.8241754, n(440)
replace LargestPower = 1.0000 in 139

power cox 0.8241754, n(290)
replace LargestPower = 1.0000 in 140

power cox 0.8241754, n(198)
replace LargestPower = 0.9999 in 141

power cox 0.8241754, n(302)
replace LargestPower = 1.0000 in 142

*Tang et al power estimate using fixed study ln(HR)
power cox 0.7323679, n(169)
replace FixedPower = 0.9974 in 138

power cox 0.7323679, n(440)
replace FixedPower = 1.0000 in 139

power cox 0.7323679, n(290)
replace FixedPower = 1.0000 in 140

power cox 0.7323679, n(198)
replace FixedPower = 0.9993 in 141

power cox 0.7323679, n(302)
replace FixedPower = 1.0000 in 142

*Tang et al power estimate using random study ln(HR)
power cox 0.7323679, n(169)
replace RandomPower = 0.9974 in 138

power cox 0.7323679, n(440)
replace RandomPower = 1.0000 in 139

power cox 0.7323679, n(290)
replace RandomPower = 1.0000 in 140

power cox 0.7323679, n(198)
replace RandomPower = 0.9993 in 141

power cox 0.7323679, n(302)
replace RandomPower = 1.0000 in 142


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//	            CLM SR RFS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.7929925, n(61)
replace LargestPower = 0.8722 in 143

power cox 0.7929925, n(198)
replace LargestPower = 0.9999 in 144

power cox 0.7929925, n(440)
replace LargestPower = 1.0000 in 145

power cox 0.7929925, n(96)
replace LargestPower = 0.9729 in 146

*Tang et al power estimate using fixed study ln(HR)
power cox 0.6471033, n(61)
replace FixedPower = 0.7147 in 143

power cox 0.6471033, n(198)
replace FixedPower = 0.9952 in 144

power cox 0.6471033, n(440)
replace FixedPower = 1.0000 in 145

power cox 0.6471033, n(96)
replace FixedPower = 0.8869 in 146

*Tang et al power estimate using random study ln(HR)
power cox 0.6312718, n(61)
replace RandomPower = 0.6933 in 143

power cox 0.6312718, n(198)
replace RandomPower = 0.9935 in 144

power cox 0.6312718, n(440)
replace RandomPower = 1.0000 in 145

power cox 0.6312718, n(96)
replace RandomPower = 0.8713 in 146


/////////////////////////////////////////////////
//					       //
//  	           Tang H et al.	       //
//	            CLM NS RFS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.5128236, n(98)
replace LargestPower = 0.7185 in 147

power cox 0.5128236, n(92)
replace LargestPower = 0.6913 in 148

*Tang et al power estimate using fixed study ln(HR)
power cox 0.8415672, n(98)
replace FixedPower = 0.9863 in 147

power cox 0.8415672, n(92)
replace FixedPower = 0.9811 in 148

*Tang et al power estimate using random study ln(HR)
power cox 0.8458683, n(98)
replace RandomPower = 0.9870 in 147

power cox 0.8458683, n(92)
replace RandomPower = 0.9820 in 148


/////////////////////////////////////////////////
//					       //
//  	         Malietzis G et al.	       //
//		    Colo Chemo DFS	       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.4121096, n(222)
replace LargestPower = 0.8665 in 149

power cox 0.4121096, n(243)
replace LargestPower = 0.8947 in 150

power cox 0.4121096, n(50)
replace LargestPower = 0.3075 in 151

*Tang et al power estimate using fixed study ln(HR)
power cox 0.4252677, n(222)
replace FixedPower = 0.8865 in 149

power cox 0.4252677, n(243)
replace FixedPower = 0.9122 in 150

power cox 0.4252677, n(50)
replace FixedPower = 0.3240 in 151

*Tang et al power estimate using random study ln(HR)
power cox 0.4252677, n(222)
replace RandomPower = 0.8865 in 149

power cox 0.4252677, n(243)
replace RandomPower = 0.9122 in 150

power cox 0.4252677, n(50)
replace RandomPower = 0.3240 in 151


/////////////////////////////////////////////////
//					       //
//  	         Malietzis G et al.	       //
//		    Colo SR DFS		       //
//					       //
/////////////////////////////////////////////////

*Tang et al power estimate using largest study ln(HR)
power cox 0.2231435, n(302)
replace LargestPower = 0.4916 in 152

power cox 0.2231435, n(115)
replace LargestPower = 0.2226 in 153

power cox 0.2231435, n(141)
replace LargestPower = 0.2627 in 154

power cox 0.2231435, n(1040)
replace LargestPower = 0.9493 in 155

power cox 0.2231435, n(506)
replace LargestPower = 0.7088 in 156

power cox 0.2231435, n(297)
replace LargestPower = 0.4852 in 157

power cox 0.2231435, n(122)
replace LargestPower = 0.2334 in 158

*Tang et al power estimate using fixed study ln(HR)
power cox 0.6259384, n(302)
replace FixedPower = 0.9997 in 152

power cox 0.6259384, n(115)
replace FixedPower = 0.9187 in 153

power cox 0.6259384, n(141)
replace FixedPower = 0.9605 in 154

power cox 0.6259384, n(1040)
replace FixedPower = 1.0000 in 155

power cox 0.6259384, n(506)
replace FixedPower = 1.0000 in 156

power cox 0.6259384, n(297)
replace FixedPower = 0.9997 in 157

power cox 0.6259384, n(122)
replace FixedPower = 0.9328 in 158

*Tang et al power estimate using random study ln(HR)
power cox 0.7419373, n(302)
replace RandomPower = 1.0000 in 152

power cox 0.7419373, n(115)
replace RandomPower = 0.9782 in 153

power cox 0.7419373, n(141)
replace RandomPower = 0.9928 in 154

power cox 0.7419373, n(1040)
replace RandomPower = 1.0000 in 155

power cox 0.7419373, n(506)
replace RandomPower = 1.0000 in 156

power cox 0.7419373, n(297)
replace RandomPower = 0.9997 in 157

power cox 0.7419373, n(122)
replace RandomPower = 0.9837 in 158


export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Gast.xlsx"


**power of individual studies in gastrointestinal cancers

clear
 
import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("Urinary") firstrow
 
gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)
 
/////////////////////////////////////////////////
//					       //
//  	             Wei Y et al.	       //
//		      Urinary OS	       //
//					       //
/////////////////////////////////////////////////

*Wei et al power estimate using largest study ln(HR)
power cox .1739533, n(109)
replace LargestPower = .1464 in 1

power cox .1739533, n(100)
replace LargestPower = .1378 in 2

power cox .1739533, n(48)
replace LargestPower = .0873 in 3

power cox .1739533, n(678)
replace LargestPower = .6197 in 4

power cox .1739533, n(58)
replace LargestPower = .0972 in 5

power cox .1739533, n(362)
replace LargestPower = .3801 in 6

power cox .1739533, n(227)
replace LargestPower = .2580 in 7

power cox .1739533, n(97)
replace LargestPower = .1349 in 8

power cox .1739533, n(85)
replace LargestPower = .1234 in 9

power cox .1739533, n(265)
replace LargestPower = .2932 in 10

power cox .1739533, n(68)
replace LargestPower = .1070 in 11

power cox .1739533, n(1112)
replace LargestPower = .8265 in 12

power cox .1739533, n(182)
replace LargestPower = .2158 in 13

*Wei et al power estimate using fixed study ln(HR)
power cox .4382549, n(109)
replace FixedPower = .6285 in 1

power cox .4382549, n(100)
replace FixedPower = .5915 in 2

power cox .4382549, n(48)
replace FixedPower = .3293 in 3

power cox .4382549, n(678)
replace FixedPower = .9999 in 4

power cox .4382549, n(58)
replace FixedPower = .3855 in 5

power cox .4382549, n(362)
replace FixedPower = .9864 in 6

power cox .4382549, n(227)
replace FixedPower = .9101 in 7

power cox .4382549, n(97)
replace FixedPower = .5786 in 8

power cox .4382549, n(85)
replace FixedPower = .5240 in 9

power cox .4382549, n(265)
replace FixedPower = .9460 in 10

power cox .4382549, n(68)
replace FixedPower = .4392 in 11

power cox .4382549, n(1112)
replace FixedPower = 1.000 in 12

power cox .4382549, n(182)
replace FixedPower = .8404 in 13

*Wei et al power estimate using random study ln(HR)
power cox .5933269, n(109)
replace RandomPower = .8723 in 1

power cox .5933269, n(100)
replace RandomPower = .8430 in 2

power cox .5933269, n(48)
replace RandomPower = .5380 in 3

power cox .5933269, n(678)
replace RandomPower = 1.000 in 4

power cox .5933269, n(58)
replace RandomPower = .6177 in 5

power cox .5933269, n(362)
replace RandomPower = .9999 in 6

power cox .5933269, n(227)
replace RandomPower = .9940 in 7

power cox .5933269, n(97)
replace RandomPower = .8319 in 8

power cox .5933269, n(85)
replace RandomPower = .7809 in 9

power cox .5933269, n(265)
replace RandomPower = .9979 in 10

power cox .5933269, n(68)
replace RandomPower = .6867 in 11

power cox .5933269, n(1112)
replace RandomPower = 1.000 in 12

power cox .5933269, n(182)
replace RandomPower = .9794 in 13

 
/////////////////////////////////////////////////
//					       //
//  		   Luo Y et al.		       //
//		      UU RFS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .3220835, n(137)
replace LargestPower = .4701 in 14

power cox .3220835, n(665)
replace LargestPower = .9858 in 15

*Luo et al power estimate using fixed study ln(HR)
power cox .3852624, n(137)
replace FixedPower = .6159 in 14

power cox .3852624, n(665)
replace FixedPower = .9987 in 15

*Luo et al power estimate using random study ln(HR)
power cox .4054651, n(137)
replace RandomPower = .6602 in 14

power cox .4054651, n(665)
replace RandomPower = .9995 in 15

 
/////////////////////////////////////////////////
//					       //
//  		    Luo Y et al.	       //
//		     Bladder OS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .4700036, n(68)
replace LargestPower = .4912 in 16

power cox .4700036, n(424)
replace LargestPower = .9980 in 17

power cox .4700036, n(899)
replace LargestPower = 1.000 in 18

power cox .4700036, n(419)
replace LargestPower = .9978 in 19

*Luo et al power estimate using fixed study ln(HR)
power cox .5187938, n(68)
replace FixedPower = .5711 in 16

power cox .5187938, n(424)
replace FixedPower = .9996 in 17

power cox .5187938, n(899)
replace FixedPower = 1.000 in 18

power cox .5187938, n(419)
replace FixedPower = .9996 in 19

*Luo et al power estimate using random study ln(HR)
power cox .5187938, n(68)
replace RandomPower = .5711 in 16

power cox .5187938, n(424)
replace RandomPower = .9996 in 17

power cox .5187938, n(899)
replace RandomPower = 1.000 in 18

power cox .5187938, n(419)
replace RandomPower = .9996 in 19


/////////////////////////////////////////////////
//					       //
//  	          Luo Y et al.		       //
//		   Bladder RFS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .3987761, n(424)
replace LargestPower = .9841 in 20

power cox .3987761, n(107)
replace LargestPower = .5408 in 21

*Luo et al power estimate using fixed study ln(HR)
power cox .4382549, n(424)
replace FixedPower = .9946 in 20

power cox .4382549, n(107)
replace FixedPower = .6205 in 21

*Luo et al power estimate using random study ln(HR)
power cox .4382549, n(424)
replace RandomPower = .9946 in 20

power cox .4382549, n(107)
replace RandomPower = .6205 in 21


/////////////////////////////////////////////////
//					       //
//  		    Li X et al.		       //
//		     UUB CSS		       //
//					       //
/////////////////////////////////////////////////

*Li et al power estimate using largest study ln(HR)
power cox .0676586, n(189)
replace LargestPower = .0675 in 22

power cox .0676586, n(137)
replace LargestPower = .0589 in 23

power cox .0676586, n(202)
replace LargestPower = .0695 in 24

power cox .0676586, n(665)
replace LargestPower = .1384 in 25

power cox .0676586, n(424)
replace LargestPower = .1032 in 26

power cox .0676586, n(899)
replace LargestPower = .1722 in 27

power cox .0676586, n(234)
replace LargestPower = .0746 in 28

power cox .0676586, n(410)
replace LargestPower = .1012 in 29

power cox .0676586, n(185)
replace LargestPower = .0668 in 30

power cox .0676586, n(277)
replace LargestPower = .0812 in 31

power cox .0676586, n(420)
replace LargestPower = .1026 in 32

power cox .0676586, n(286)
replace LargestPower = .0826 in 33

power cox .0676586, n(385)
replace LargestPower = .0975 in 34

power cox .0676586, n(418)
replace LargestPower = .1023 in 35

power cox .0676586, n(110)
replace LargestPower = .0542 in 36

power cox .0676586, n(2477)
replace LargestPower = .3912 in 37

power cox .0676586, n(205)
replace LargestPower = .0700 in 38

*Li et al power estimate using fixed study ln(HR)
power cox .2926696, n(189)
replace FixedPower = .5207 in 22

power cox .2926696, n(137)
replace FixedPower = .4024 in 23

power cox .2926696, n(202)
replace FixedPower = .5477 in 24

power cox .2926696, n(665)
replace FixedPower = .9651 in 25

power cox .2926696, n(424)
replace FixedPower = .8539 in 26

power cox .2926696, n(899)
replace FixedPower = .9924 in 27

power cox .2926696, n(234)
replace FixedPower = .6097 in 28

power cox .2926696, n(410)
replace FixedPower = .8421 in 29

power cox .2926696, n(185)
replace FixedPower = .5121 in 30

power cox .2926696, n(277)
replace FixedPower = .6828 in 31

power cox .2926696, n(420)
replace FixedPower = .8506 in 32

power cox .2926696, n(286)
replace FixedPower = .6966 in 33

power cox .2926696, n(385)
replace FixedPower = .8189 in 34

power cox .2926696, n(418)
replace FixedPower = .8489 in 35

power cox .2926696, n(110)
replace FixedPower = .3353 in 36

power cox .2926696, n(2477)
replace FixedPower = 1.000 in 37

power cox .2926696, n(205)
replace FixedPower = .5538 in 38

*Li et al power estimate using random study ln(HR)
power cox .48858, n(189)
replace RandomPower = .9190 in 22

power cox .48858, n(137)
replace RandomPower = .8158 in 23

power cox .48858, n(202)
replace RandomPower = .9347 in 24

power cox .48858, n(665)
replace RandomPower = 1.000 in 25

power cox .48858, n(424)
replace RandomPower = .9989 in 26

power cox .48858, n(899)
replace RandomPower = 1.000 in 27

power cox .48858, n(234)
replace RandomPower = .9622 in 28

power cox .48858, n(410)
replace RandomPower = .9986 in 29

power cox .48858, n(185)
replace RandomPower = .9135 in 30

power cox .48858, n(277)
replace RandomPower = .9824 in 31

power cox .48858, n(420)
replace RandomPower = .9988 in 32

power cox .48858, n(286)
replace RandomPower = .9850 in 33

power cox .48858, n(385)
replace RandomPower = .9977 in 34

power cox .48858, n(418)
replace RandomPower = .9988 in 35

power cox .48858, n(110)
replace RandomPower = .7265 in 36

power cox .48858, n(2477)
replace RandomPower = 1.000 in 37

power cox .48858, n(205)
replace RandomPower = .9379 in 38


/////////////////////////////////////////////////
//					       //
//  		   Li X et al.		       //
//		     UUB OS		       //
//					       //
/////////////////////////////////////////////////

*Li et al power estimate using largest study ln(HR)
power cox .4762342, n(202)
replace LargestPower = .9228 in 39

power cox .4762342, n(68)
replace LargestPower = .5014 in 40

power cox .4762342, n(292)
replace LargestPower = .9825 in 41

power cox .4762342, n(424)
replace LargestPower = .9984 in 42

power cox .4762342, n(899)
replace LargestPower = 1.000 in 43

power cox .4762342, n(410)
replace LargestPower = .9979 in 44

power cox .4762342, n(185)
replace LargestPower = .8995 in 45

power cox .4762342, n(420)
replace LargestPower = .9982 in 46

power cox .4762342, n(385)
replace LargestPower = .9967 in 47

power cox .4762342, n(418)
replace LargestPower = .9982 in 48

power cox .4762342, n(110)
replace LargestPower = .7045 in 49

power cox .4762342, n(74)
replace LargestPower = .5352 in 50

power cox .4762342, n(124)
replace LargestPower = .7554 in 51

power cox .4762342, n(419)
replace LargestPower = .9982 in 52

power cox .4762342, n(129)
replace LargestPower = .7717 in 53

power cox .4762342, n(205)
replace LargestPower = .9264 in 54

power cox .4762342, n(23)
replace LargestPower = .2067 in 55

*Li et al power estimate using fixed study ln(HR)
power cox .2851789, n(202)
replace FixedPower = .5266 in 39

power cox .2851789, n(68)
replace FixedPower = .2165 in 40

power cox .2851789, n(292)
replace FixedPower = .6832 in 41

power cox .2851789, n(424)
replace FixedPower = .8355 in 42

power cox .2851789, n(899)
replace FixedPower = .9897 in 43

power cox .2851789, n(410)
replace FixedPower = .8231 in 44

power cox .2851789, n(185)
replace FixedPower = .4918 in 45

power cox .2851789, n(420)
replace FixedPower = .8320 in 46

power cox .2851789, n(385)
replace FixedPower = .7989 in 47

power cox .2851789, n(418)
replace FixedPower = .8303 in 48

power cox .2851789, n(110)
replace FixedPower = .3212 in 49

power cox .2851789, n(74)
replace FixedPower = .2317 in 50

power cox .2851789, n(124)
replace FixedPower = .3549 in 51

power cox .2851789, n(419)
replace FixedPower = .8312 in 52

power cox .2851789, n(129)
replace FixedPower = .3668 in 53

power cox .2851789, n(205)
replace FixedPower = .5325 in 54

power cox .2851789, n(23)
replace FixedPower = .1010 in 55

*Li et al power estimate using random study ln(HR)
power cox .5423243, n(202)
replace RandomPower = .9709 in 39

power cox .5423243, n(68)
replace RandomPower = .6088 in 40

power cox .5423243, n(292)
replace RandomPower = .9962 in 41

power cox .5423243, n(424)
replace RandomPower = .9999 in 42

power cox .5423243, n(899)
replace RandomPower = 1.000 in 43

power cox .5423243, n(410)
replace RandomPower = .9998 in 44

power cox .5423243, n(185)
replace RandomPower = .9580 in 45

power cox .5423243, n(420)
replace RandomPower = .9998 in 46

power cox .5423243, n(385)
replace RandomPower = .9996 in 47

power cox .5423243, n(418)
replace RandomPower = .9998 in 48

power cox .5423243, n(110)
replace RandomPower = .8117 in 49

power cox .5423243, n(74)
replace RandomPower = .6453 in 50

power cox .5423243, n(124)
replace RandomPower = .8553 in 51

power cox .5423243, n(419)
replace RandomPower = .9998 in 52

power cox .5423243, n(129)
replace RandomPower = .8686 in 53

power cox .5423243, n(205)
replace RandomPower = .9727 in 54

power cox .5423243, n(23)
replace RandomPower = .2548 in 55


/////////////////////////////////////////////////
//					       //
//  		    Li X et al.		       //
//		     UUB PFS		       //
//					       //
/////////////////////////////////////////////////

*Li et al power estimate using largest study ln(HR)
power cox .0487902, n(137)
replace LargestPower = .0470 in 56

power cox .0487902, n(665)
replace LargestPower = .0916 in 57

power cox .0487902, n(292)
replace LargestPower = .0614 in 58

power cox .0487902, n(107)
replace LargestPower = .0439 in 59

power cox .0487902, n(424)
replace LargestPower = .0725 in 60

power cox .0487902, n(234)
replace LargestPower = .0563 in 61

power cox .0487902, n(410)
replace LargestPower = .0713 in 62

power cox .0487902, n(277)
replace LargestPower = .0601 in 63

power cox .0487902, n(418)
replace LargestPower = .0720 in 64

power cox .0487902, n(140)
replace LargestPower = .0473 in 65

power cox .0487902, n(110)
replace LargestPower = .0442 in 66

power cox .0487902, n(74)
replace LargestPower = .0400 in 67

power cox .0487902, n(2477)
replace LargestPower = .2279 in 68

power cox .0487902, n(419)
replace LargestPower = .0721 in 69

power cox .0487902, n(605)
replace LargestPower = .0869 in 70

power cox .0487902, n(205)
replace LargestPower = .0536 in 71

power cox .0487902, n(178)
replace LargestPower = .0511 in 72

power cox .0487902, n(23)
replace LargestPower = .0327 in 73

power cox .0487902, n(1117)
replace LargestPower = .1262 in 74

*Li et al power estimate using fixed study ln(HR)
power cox .3920421, n(137)
replace FixedPower = .6310 in 56

power cox .3920421, n(665)
replace FixedPower = .9990 in 57

power cox .3920421, n(292)
replace FixedPower = .9177 in 58

power cox .3920421, n(107)
replace FixedPower = .5270 in 59

power cox .3920421, n(424)
replace FixedPower = .9811 in 60

power cox .3920421, n(234)
replace FixedPower = .8505 in 61

power cox .3920421, n(410)
replace FixedPower = .9777 in 62

power cox .3920421, n(277)
replace FixedPower = .9036 in 63

power cox .3920421, n(418)
replace FixedPower = .9797 in 64

power cox .3920421, n(140)
replace FixedPower = .6403 in 65

power cox .3920421, n(110)
replace FixedPower = .5382 in 66

power cox .3920421, n(74)
replace FixedPower = .3921 in 67

power cox .3920421, n(2477)
replace FixedPower = 1.000 in 68

power cox .3920421, n(419)
replace FixedPower = .9799 in 69

power cox .3920421, n(605)
replace FixedPower = .9979 in 70

power cox .3920421, n(205)
replace FixedPower = .8014 in 71

power cox .3920421, n(178)
replace FixedPower = .7439 in 72

power cox .3920421, n(23)
replace FixedPower = .1539 in 73

power cox .3920421, n(1117)
replace FixedPower = 1.000 in 74

*Li et al power estimate using random study ln(HR)
power cox .5187938, n(137)
replace RandomPower = .8591 in 56

power cox .5187938, n(665)
replace RandomPower = 1.000 in 57

power cox .5187938, n(292)
replace RandomPower = .9933 in 58

power cox .5187938, n(107)
replace RandomPower = .7652 in 59

power cox .5187938, n(424)
replace RandomPower = .9996 in 60

power cox .5187938, n(234)
replace RandomPower = .9777 in 61

power cox .5187938, n(410)
replace RandomPower = .9995 in 62

power cox .5187938, n(277)
replace RandomPower = .9908 in 63

power cox .5187938, n(418)
replace RandomPower = .9996 in 64

power cox .5187938, n(140)
replace RandomPower = .8663 in 65

power cox .5187938, n(110)
replace RandomPower = .7766 in 66

power cox .5187938, n(74)
replace RandomPower = .6070 in 67

power cox .5187938, n(2477)
replace RandomPower = 1.000 in 68

power cox .5187938, n(419)
replace RandomPower = .9996 in 69

power cox .5187938, n(605)
replace RandomPower = 1.000 in 70

power cox .5187938, n(205)
replace RandomPower = .9603 in 71

power cox .5187938, n(178)
replace RandomPower = .9333 in 72

power cox .5187938, n(23)
replace RandomPower = .2370 in 73

power cox .5187938, n(1117)
replace RandomPower = 1.000 in 74


/////////////////////////////////////////////////
//					       //
//  	             Luo Y et al.	       //
//		     Prostate PFS	       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .2468601, n(848)
replace LargestPower = .9489 in 75

power cox .2468601, n(33)
replace LargestPower = .1055 in 76

*Luo et al power estimate using fixed study ln(HR)
power cox .2546422, n(848)
replace FixedPower = .9597 in 75

power cox .2546422, n(33)
replace FixedPower = .1096 in 76

*Luo et al power estimate using random study ln(HR)
power cox .2546422, n(848)
replace RandomPower = .9597 in 75

power cox .2546422, n(33)
replace RandomPower = .1096 in 76


/////////////////////////////////////////////////
//					       //
//  		   Yin X et al.		       //
//	        Prostate Local OS	       //
//					       //
/////////////////////////////////////////////////

*Yin et al power estimate using largest study ln(HR)
power cox .1133287, n(8350)
replace LargestPower = .9994 in 77

power cox .1133287, n(415)
replace LargestPower = .2102 in 78

*Yin et al power estimate using fixed study ln(HR)
power cox .1397619, n(8350)
replace FixedPower = 1.000 in 77

power cox .1397619, n(415)
replace FixedPower = .2958 in 78

*Yin et al power estimate using random study ln(HR)
power cox .3715636, n(8350)
replace RandomPower = 1.000 in 77

power cox .3715636, n(415)
replace RandomPower = .9660 in 78


/////////////////////////////////////////////////
//					       //
//  		    Yin X et al.	       //
//		   Prostate CR OS	       //
//					       //
/////////////////////////////////////////////////

*Yin et al power estimate using largest study ln(HR)
power cox .4382549, n(57)
replace LargestPower = .3800 in 79

power cox .4382549, n(101)
replace LargestPower = .5957 in 80

power cox .4382549, n(42)
replace LargestPower = .2946 in 81

power cox .4382549, n(755)
replace LargestPower = 1.000 in 82

power cox .4382549, n(157)
replace LargestPower = .7840 in 83

power cox .4382549, n(185)
replace LargestPower = .8463 in 84

power cox .4382549, n(848)
replace LargestPower = 1.000 in 85

power cox .4382549, n(238)
replace LargestPower = .9223 in 86

power cox .4382549, n(182)
replace LargestPower = .8404 in 87

*Yin et al power estimate using fixed study ln(HR)
power cox .4446858, n(57)
replace FixedPower = .3892 in 79

power cox .4446858, n(101)
replace FixedPower = .6082 in 80

power cox .4446858, n(42)
replace FixedPower = .3019 in 81

power cox .4446858, n(755)
replace FixedPower = 1.000 in 82

power cox .4446858, n(157)
replace FixedPower = .7956 in 83

power cox .4446858, n(185)
replace FixedPower = .8564 in 84

power cox .4446858, n(848)
replace FixedPower = 1.000 in 85

power cox .4446858, n(238)
replace FixedPower = .9292 in 86

power cox .4446858, n(182)
replace FixedPower = .8507 in 87

*Yin et al power estimate using random study ln(HR)
power cox .4446858, n(57)
replace RandomPower = .3892 in 79

power cox .4446858, n(101)
replace RandomPower = .6082 in 80

power cox .4446858, n(42)
replace RandomPower = .3019 in 81

power cox .4446858, n(755)
replace RandomPower = 1.000 in 82

power cox .4446858, n(157)
replace RandomPower = .7956 in 83

power cox .4446858, n(185)
replace RandomPower = .8564 in 84

power cox .4446858, n(848)
replace RandomPower = 1.000 in 85

power cox .4446858, n(238)
replace RandomPower = .9292 in 86

power cox .4446858, n(182)
replace RandomPower = .8507 in 87


/////////////////////////////////////////////////
//					       //
//  		   Cao J et al.		       //
//		 Prostate CR PFS	       //
//					       //
/////////////////////////////////////////////////

*Cao et al power estimate using largest study ln(HR)
power cox .3506569, n(42)
replace LargestPower = .2051 in 88

power cox .3506569, n(57)
replace LargestPower = .2623 in 89

power cox .3506569, n(654)
replace LargestPower = .9942 in 90

power cox .3506569, n(55)
replace LargestPower = .2547 in 91

power cox .3506569, n(134)
replace LargestPower = .5277 in 92

power cox .3506569, n(687)
replace LargestPower = .9958 in 93

*Cao et al power estimate using fixed study ln(HR)
power cox .3987761, n(42)
replace FixedPower = .2521 in 88

power cox .3987761, n(57)
replace FixedPower = .3247 in 89

power cox .3987761, n(654)
replace FixedPower = .9992 in 90

power cox .3987761, n(55)
replace FixedPower = .3152 in 91

power cox .3987761, n(134)
replace FixedPower = .6361 in 92

power cox .3987761, n(687)
replace FixedPower = .9995 in 93

*Cao et al power estimate using random study ln(HR)
power cox .5007753, n(42)
replace RandomPower = .3680 in 88

power cox .5007753, n(57)
replace RandomPower = .4723 in 89

power cox .5007753, n(654)
replace RandomPower = 1.000 in 90

power cox .5007753, n(55)
replace RandomPower = .4590 in 91

power cox .5007753, n(134)
replace RandomPower = .8260 in 92

power cox .5007753, n(687)
replace RandomPower = 1.000 in 93


/////////////////////////////////////////////////
//					       //
//  		   Lucca I et al.	       //
//			UC OS		       //
//					       //
/////////////////////////////////////////////////

*Lucca et al power estimate using largest study ln(HR)
power cox .10436, n(899)
replace LargestPower = .3463 in 94

power cox .10436, n(424)
replace LargestPower = .1879 in 95

power cox .10436, n(68)
replace LargestPower = .0630 in 96

power cox .10436, n(4061)
replace LargestPower = .9139 in 97

*Lucca et al power estimate using fixed study ln(HR)
power cox .1823216, n(899)
replace FixedPower = .7803 in 94

power cox .1823216, n(424)
replace FixedPower = .4670 in 95

power cox .1823216, n(68)
replace FixedPower = .1135 in 96

power cox .1823216, n(4061)
replace FixedPower = .9999 in 97

*Lucca et al power estimate using random study ln(HR)
power cox .4121096, n(899)
replace RandomPower = 1.000 in 94

power cox .4121096, n(424)
replace RandomPower = .9888 in 95

power cox .4121096, n(68)
replace RandomPower = .3971 in 96

power cox .4121096, n(4061)
replace RandomPower = 1.000 in 97


/////////////////////////////////////////////////
//					       //
//  	           Marchioni M et al.          //
//			 UC RFS		       //
//					       //
/////////////////////////////////////////////////

*Marchioni et al power estimate using largest study ln(HR)
power cox .3220835, n(137)
replace LargestPower = .4701 in 98

power cox .3220835, n(665)
replace LargestPower = .9858 in 99

power cox .3220835, n(234)
replace LargestPower = .6927 in 100

power cox .3220835, n(277)
replace LargestPower = .7643 in 101

*Marchioni et al power estimate using fixed study ln(HR)
power cox .4252677, n(137)
replace FixedPower = .7015 in 98

power cox .4252677, n(665)
replace FixedPower = .9998 in 99

power cox .4252677, n(234)
replace FixedPower = .9019 in 100

power cox .4252677, n(277)
replace FixedPower = .9428 in 101

*Marchioni et al power estimate using random study ln(HR)
power cox .4252677, n(137)
replace RandomPower = .7015 in 98

power cox .4252677, n(665)
replace RandomPower = .9998 in 99

power cox .4252677, n(234)
replace RandomPower = .9019 in 100

power cox .4252677, n(277)
replace RandomPower = .9428 in 101


/////////////////////////////////////////////////
//					       //
//  		   Luo Y M et al.	       //
//		     Renal OS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .5766134, n(362)
replace LargestPower = .9998 in 102

power cox .5766134, n(129)
replace LargestPower = .9057 in 103

power cox .5766134, n(100)
replace LargestPower = .8220 in 104

power cox .5766134, n(58)
replace LargestPower = .5932 in 105

power cox .5766134, n(227)
replace LargestPower = .9914 in 106

power cox .5766134, n(678)
replace LargestPower = 1.000 in 107

power cox .5766134, n(53)
replace LargestPower = .5553 in 108

power cox .5766134, n(114)
replace LargestPower = .8683 in 109

power cox .5766134, n(827)
replace LargestPower = 1.000 in 110

power cox .5766134, n(244)
replace LargestPower = .9945 in 111

power cox .5766134, n(357)
replace LargestPower = .9998 in 112

power cox .5766134, n(73)
replace LargestPower = .6926 in 113

power cox .5766134, n(151)
replace LargestPower = .9433 in 114

*Luo et al power estimate using fixed study ln(HR)
power cox .5822156, n(362)
replace FixedPower = .9998 in 102

power cox .5822156, n(129)
replace FixedPower = .9109 in 103

power cox .5822156, n(100)
replace FixedPower = .8292 in 104

power cox .5822156, n(58)
replace FixedPower = .6014 in 105

power cox .5822156, n(227)
replace FixedPower = .9924 in 106

power cox .5822156, n(678)
replace FixedPower = 1.000 in 107

power cox .5822156, n(53)
replace FixedPower = .5633 in 108

power cox .5822156, n(114)
replace FixedPower = .8746 in 109

power cox .5822156, n(827)
replace FixedPower = 1.000 in 110

power cox .5822156, n(244)
replace FixedPower = .9952 in 111

power cox .5822156, n(357)
replace FixedPower = .9998 in 112

power cox .5822156, n(73)
replace FixedPower = .7010 in 113

power cox .5822156, n(151)
replace FixedPower = .9471 in 114

*Luo et al power estimate using random study ln(HR)
power cox .6418539, n(362)
replace RandomPower = 1.000 in 102

power cox .6418539, n(129)
replace RandomPower = .9540 in 103

power cox .6418539, n(100)
replace RandomPower = .8942 in 104

power cox .6418539, n(58)
replace RandomPower = .6859 in 105

power cox .6418539, n(227)
replace RandomPower = .9980 in 106

power cox .6418539, n(678)
replace RandomPower = 1.000 in 107

power cox .6418539, n(53)
replace RandomPower = .6467 in 108

power cox .6418539, n(114)
replace RandomPower = .9288 in 109

power cox .6418539, n(827)
replace RandomPower = 1.000 in 110

power cox .6418539, n(244)
replace RandomPower = .9989 in 111

power cox .6418539, n(357)
replace RandomPower = 1.000 in 112

power cox .6418539, n(73)
replace RandomPower = .7829 in 113

power cox .6418539, n(151)
replace RandomPower = .9764 in 114


/////////////////////////////////////////////////
//					       //
//  	            Na N et al.		       //
//	             Renal PFS		       //
//					       //
/////////////////////////////////////////////////

*Na et al power estimate using largest study ln(HR)
power cox .4317824, n(58)
replace LargestPower = .3761 in 115

power cox .4317824, n(100)
replace LargestPower = .5788 in 116

power cox .4317824, n(23)
replace LargestPower = .1776 in 117

power cox .4317824, n(151)
replace LargestPower = .7558 in 118

power cox .4317824, n(45)
replace LargestPower = .3044 in 119

power cox .4317824, n(145)
replace LargestPower = .7388 in 120

power cox .4317824, n(278)
replace LargestPower = .9495 in 121

power cox .4317824, n(373)
replace LargestPower = .9864 in 122

*Na et al power estimate using fixed study ln(HR)
power cox .1906204, n(58)
replace FixedPower = .1086 in 115

power cox .1906204, n(100)
replace FixedPower = .1570 in 116

power cox .1906204, n(23)
replace FixedPower = .0664 in 117

power cox .1906204, n(151)
replace FixedPower = .2151 in 118

power cox .1906204, n(45)
replace FixedPower = .0933 in 119

power cox .1906204, n(145)
replace FixedPower = .2083 in 120

power cox .1906204, n(278)
replace FixedPower = .3554 in 121

power cox .1906204, n(373)
replace FixedPower = .4526 in 122

*Na et al power estimate using random study ln(HR)
power cox .7514161, n(58)
replace RandomPower = .8163 in 115

power cox .7514161, n(100)
replace RandomPower = .9638 in 116

power cox .7514161, n(23)
replace RandomPower = .4372 in 117

power cox .7514161, n(151)
replace RandomPower = .9961 in 118

power cox .7514161, n(45)
replace RandomPower = .7124 in 119

power cox .7514161, n(145)
replace RandomPower = .9948 in 120

power cox .7514161, n(278)
replace RandomPower = 1.000 in 121

power cox .7514161, n(373)
replace RandomPower = 1.000 in 122


/////////////////////////////////////////////////
//					       //
//  		    Luo Y et al.	       //
//		     Renal CSS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox .722706, n(678)
replace LargestPower = 1.000 in 123

power cox .722706, n(827)
replace LargestPower = 1.000 in 124

power cox .722706, n(114)
replace LargestPower = .9712 in 125

power cox .722706, n(109)
replace LargestPower = .9651 in 126

*Luo et al power estimate using fixed study ln(HR)
power cox .1823216, n(678)
replace FixedPower = .6605 in 123

power cox .1823216, n(827)
replace FixedPower = .7459 in 124

power cox .1823216, n(114)
replace FixedPower = .1619 in 125

power cox .1823216, n(109)
replace FixedPower = .1567 in 126

*Luo et al power estimate using random study ln(HR)
power cox .3220835, n(678)
replace RandomPower = .9872 in 123

power cox .3220835, n(827)
replace RandomPower = .9962 in 124

power cox .3220835, n(114)
replace RandomPower = .4050 in 125

power cox .3220835, n(109)
replace RandomPower = .3903 in 126


/////////////////////////////////////////////////
//					       //
//  		     Shen M et al.	       //
//		    Renal Intra OS	       //
//					       //
/////////////////////////////////////////////////

*Shen et al power estimate using largest study ln(HR)
power cox 1.131402, n(85)
replace LargestPower = .9994 in 127

power cox 1.131402, n(121)
replace LargestPower = 1.000 in 128

*Shen et al power estimate using fixed study ln(HR)
power cox .9969487, n(85)
replace FixedPower = .9958 in 127

power cox .9969487, n(121)
replace FixedPower = .9998 in 128

*Shen et al power estimate using random study ln(HR)
power cox .9969487, n(85)
replace RandomPower = .9958 in 127

power cox .9969487, n(121)
replace RandomPower = .9998 in 128


/////////////////////////////////////////////////
//					       //
//  		  Luo Y et al.	               //
//		   Renal RFS		       //
//					       //
/////////////////////////////////////////////////

*Luo et al power estimate using largest study ln(HR)
power cox 1.121678, n(192)
replace LargestPower = 1.000 in 129

power cox 1.121678, n(227)
replace LargestPower = 1.000 in 130

power cox 1.121678, n(281)
replace LargestPower = 1.000 in 131

*Luo et al power estimate using fixed study ln(HR)
power cox .6780335, n(192)
replace FixedPower = .9969 in 129

power cox .6780335, n(227)
replace FixedPower = .9992 in 130

power cox .6780335, n(281)
replace FixedPower = .9999 in 131

*Luo et al power estimate using random study ln(HR)
power cox .6780335, n(192)
replace RandomPower = .9969 in 129

power cox .6780335, n(227)
replace RandomPower = .9992 in 130

power cox .6780335, n(281)
replace RandomPower = .9999 in 131


/////////////////////////////////////////////////
//					       //
//  		   Boissier et al.	       //
//		    Renal Ad OS		       //
//					       //
/////////////////////////////////////////////////

*Boissier et al power estimate using largest study ln(HR)
power cox .6471033, n(100)
replace LargestPower = .8989 in 132

power cox .6471033, n(362)
replace LargestPower = 1.000 in 133

power cox .6471033, n(85)
replace LargestPower = .8469 in 134

power cox .6471033, n(109)
replace LargestPower = .9219 in 135

power cox .6471033, n(478)
replace LargestPower = 1.000 in 136

power cox .6471033, n(73)
replace LargestPower = .7894 in 137

power cox .6471033, n(97)
replace LargestPower = .8900 in 138

*Boissier et al power estimate using fixed study ln(HR)
power cox .4382549, n(100)
replace FixedPower = .5915 in 132

power cox .4382549, n(362)
replace FixedPower = .9864 in 133

power cox .4382549, n(85)
replace FixedPower = .5240 in 134

power cox .4382549, n(109)
replace FixedPower = .6285 in 135

power cox .4382549, n(478)
replace FixedPower = .9977 in 136

power cox .4382549, n(73)
replace FixedPower = .4650 in 137

power cox .4382549, n(97)
replace FixedPower = .5786 in 138

*Boissier et al power estimate using random study ln(HR)
power cox .6365768, n(100)
replace RandomPower = .8893 in 132

power cox .6365768, n(362)
replace RandomPower = 1.000 in 133

power cox .6365768, n(85)
replace RandomPower = .8351 in 134

power cox .6365768, n(109)
replace RandomPower = .9136 in 135

power cox .6365768, n(478)
replace RandomPower = 1.000 in 136

power cox .6365768, n(73)
replace RandomPower = .7762 in 137

power cox .6365768, n(97)
replace RandomPower = .8800 in 138


/////////////////////////////////////////////////
//					       //
//  		  Boissier et al.	       //
//		   Renal Ad PFS		       //
//					       //
/////////////////////////////////////////////////

*Boissier et al power estimate using largest study ln(HR)
power cox 1.252763, n(97)
replace LargestPower = 1.000 in 139

power cox 1.252763, n(100)
replace LargestPower = 1.000 in 140

power cox 1.252763, n(109)
replace LargestPower = 1.000 in 141

*Boissier et al power estimate using fixed study ln(HR)
power cox 1.160021, n(97)
replace FixedPower = .9999 in 139

power cox 1.160021, n(100)
replace FixedPower = .9999 in 140

power cox 1.160021, n(109)
replace FixedPower = 1.000 in 141

*Boissier et al power estimate using random study ln(HR)
power cox 1.160021, n(97)
replace RandomPower = .9999 in 139

power cox 1.160021, n(100)
replace RandomPower = .9999 in 140

power cox 1.160021, n(109)
replace RandomPower = 1.000 in 141


/////////////////////////////////////////////////
//					       //
//  		  Boissier et al.	       //
//	           Renal Loc OS		       //
//					       //
/////////////////////////////////////////////////

*Boissier et al power estimate using largest study ln(HR)
power cox .0198026, n(227)
replace LargestPower = .0351 in 142

power cox .0198026, n(114)
replace LargestPower = .0319 in 143

power cox .0198026, n(827)
replace LargestPower = .0469 in 144

*Boissier et al power estimate using fixed study ln(HR)
power cox .0198026, n(227)
replace FixedPower = .0351 in 142

power cox .0198026, n(114)
replace FixedPower = .0319 in 143

power cox .0198026, n(827)
replace FixedPower = .0469 in 144

*Boissier et al power estimate using random study ln(HR)
power cox .3784364, n(227)
replace RandomPower = .8135 in 142

power cox .3784364, n(114)
replace RandomPower = .5241 in 143

power cox .3784364, n(827)
replace RandomPower =  .9998 in 144


/////////////////////////////////////////////////
//					       //
//  		 Boissier et al.	       //
//		  Renal Loc RFS		       //
//					       //
/////////////////////////////////////////////////

*Boissier et al power estimate using largest study ln(HR)
power cox .0099503, n(352)
replace LargestPower = .0310 in 145

power cox .0099503, n(227)
replace LargestPower = .0297 in 146

power cox .0099503, n(114)
replace LargestPower = .0283 in 147

power cox .0099503, n(250)
replace LargestPower = .0300 in 148

power cox .0099503, n(192)
replace LargestPower = .0293 in 149

power cox .0099503, n(827)
replace LargestPower = .0346 in 150

*Boissier et al power estimate using fixed study ln(HR)
power cox .0099503, n(352)
replace FixedPower = .0310 in 145

power cox .0099503, n(227)
replace FixedPower = .0297 in 146

power cox .0099503, n(114)
replace FixedPower = .0283 in 147

power cox .0099503, n(250)
replace FixedPower = .0300 in 148

power cox .0099503, n(192)
replace FixedPower = .0293 in 149

power cox .0099503, n(827)
replace FixedPower = .0346 in 150

*Boissier et al power estimate using random study ln(HR)
power cox .48858, n(352)
replace RandomPower = .9956 in 145

power cox .48858, n(227)
replace RandomPower = .9573 in 146

power cox .48858, n(114)
replace RandomPower = .7416 in 147

power cox .48858, n(250)
replace RandomPower = .9715 in 148

power cox .48858, n(192)
replace RandomPower = .9229 in 149

power cox .48858, n(827)
replace RandomPower = 1.000 in 150


export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Uri.xlsx"



**power of individual studies in hepatocellular cancers

clear
 
import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("Hepatocellular") firstrow
 
gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)
 
/////////////////////////////////////////////////
//					       //
//  		    Qi X et al.		       //
//		      HCC OS		       //
//					       //
/////////////////////////////////////////////////

*Qi et al power estimate using largest study ln(HR)
power cox .6678294, n(170)
replace LargestPower = .9917 in 1

power cox .6678294, n(68)
replace LargestPower = .7863 in 2

power cox .6678294, n(105)
replace LargestPower = .9281 in 3

power cox .6678294, n(178)
replace LargestPower = .9937 in 4

power cox .6678294, n(132)
replace LargestPower = .9697 in 5

power cox .6678294, n(282)
replace LargestPower = .9999 in 6

power cox .6678294, n(825)
replace LargestPower = 1.0000 in 7

power cox .6678294, n(91)
replace LargestPower = .8898 in 8

power cox .6678294, n(150)
replace LargestPower = .9834 in 9

power cox .6678294, n(26)
replace LargestPower = .3985 in 10

power cox .6678294, n(349)
replace LargestPower = 1.000 in 11

power cox .6678294, n(142)
replace LargestPower = .9783 in 12

power cox .6678294, n(154)
replace LargestPower = .9855 in 13

power cox .6678294, n(205)
replace LargestPower = .9976 in 14

power cox .6678294, n(222)
replace LargestPower = .9987 in 15

power cox .6678294, n(256)
replace LargestPower = .9996 in 16

power cox .6678294, n(160)
replace LargestPower = .9882 in 17

power cox .6678294, n(958)
replace LargestPower = 1.000 in 18

power cox .6678294, n(104)
replace LargestPower = .9258 in 19

power cox .6678294, n(158)
replace LargestPower = .9874 in 20

power cox .6678294, n(367)
replace LargestPower = 1.000 in 21

power cox .6678294, n(318)
replace LargestPower = 1.000 in 22

power cox .6678294, n(256)
replace LargestPower = .9996 in 23

power cox .6678294, n(176)
replace LargestPower = .9932 in 24

power cox .6678294, n(80)
replace LargestPower = .8477 in 25

power cox .6678294, n(26)
replace LargestPower = .3985 in 26

power cox .6678294, n(266)
replace LargestPower = .9998 in 27

power cox .6678294, n(101)
replace LargestPower = .9186 in 28

power cox .6678294, n(112)
replace LargestPower = .9422 in 29

power cox .6678294, n(56)
replace LargestPower = .7050 in 30

power cox .6678294, n(40)
replace LargestPower = .5604 in 31

power cox .6678294, n(305)
replace LargestPower = .9999 in 32

power cox .6678294, n(178)
replace LargestPower = .9937 in 33

power cox .6678294, n(546)
replace LargestPower = 1.000 in 34

power cox .6678294, n(138)
replace LargestPower = .9752 in 35

power cox .6678294, n(65)
replace LargestPower = .7680 in 36

power cox .6678294, n(77)
replace LargestPower = .8340 in 37

power cox .6678294, n(1061)
replace LargestPower = 1.000 in 38

power cox .6678294, n(224)
replace LargestPower = .9988 in 39

*Qi et al power estimate using fixed study ln(HR)
power cox .4700036, n(170)
replace FixedPower = .8652 in 1

power cox .4700036, n(68)
replace FixedPower = .4912 in 2

power cox .4700036, n(105)
replace FixedPower = .6730 in 3

power cox .4700036, n(178)
replace FixedPower = .8801 in 4

power cox .4700036, n(132)
replace FixedPower = .7704 in 5

power cox .4700036, n(282)
replace FixedPower = .9765 in 6

power cox .4700036, n(825)
replace FixedPower = 1.0000 in 7

power cox .4700036, n(91)
replace FixedPower = .6110 in 8

power cox .4700036, n(150)
replace FixedPower = .8207 in 9

power cox .4700036, n(26)
replace FixedPower = .2231 in 10

power cox .4700036, n(349)
replace FixedPower = 0.9925 in 11

power cox .4700036, n(142)
replace FixedPower = .7997 in 12

power cox .4700036, n(154)
replace FixedPower = .8305 in 13

power cox .4700036, n(205)
replace FixedPower = .9200 in 14

power cox .4700036, n(222)
replace FixedPower = .9384 in 15

power cox .4700036, n(256)
replace FixedPower = .9641 in 16

power cox .4700036, n(160)
replace FixedPower = .8444 in 17

power cox .4700036, n(958)
replace FixedPower = 1.000 in 18

power cox .4700036, n(104)
replace FixedPower = .6688 in 19

power cox .4700036, n(158)
replace FixedPower = .8399 in 20

power cox .4700036, n(367)
replace FixedPower = 0.9945 in 21

power cox .4700036, n(318)
replace FixedPower = 0.9872 in 22

power cox .4700036, n(256)
replace FixedPower = .9641 in 23

power cox .4700036, n(176)
replace FixedPower = .8765 in 24

power cox .4700036, n(80)
replace FixedPower = .5564 in 25

power cox .4700036, n(26)
replace FixedPower = .2231 in 26

power cox .4700036, n(266)
replace FixedPower = .9695 in 27

power cox .4700036, n(101)
replace FixedPower = .6561 in 28

power cox .4700036, n(112)
replace FixedPower = .7009 in 29

power cox .4700036, n(56)
replace FixedPower = .4202 in 30

power cox .4700036, n(40)
replace FixedPower = .3179 in 31

power cox .4700036, n(305)
replace FixedPower = .9840 in 32

power cox .4700036, n(178)
replace FixedPower = .8801 in 33

power cox .4700036, n(546)
replace FixedPower = 0.9998 in 34

power cox .4700036, n(138)
replace FixedPower = .7883 in 35

power cox .4700036, n(65)
replace FixedPower = .4740 in 36

power cox .4700036, n(77)
replace FixedPower = .5407 in 37

power cox .4700036, n(1061)
replace FixedPower = 1.000 in 38

power cox .4700036, n(224)
replace FixedPower = .9403 in 39

*Qi et al power estimate using random study ln(HR)
power cox .5877867, n(170)
replace RandomPower = .9694 in 1

power cox .5877867, n(68)
replace RandomPower = .6785 in 2

power cox .5877867, n(105)
replace RandomPower = .8535 in 3

power cox .5877867, n(178)
replace RandomPower = .9751 in 4

power cox .5877867, n(132)
replace RandomPower = .9217 in 5

power cox .5877867, n(282)
replace RandomPower = .9985 in 6

power cox .5877867, n(825)
replace RandomPower = 1.0000 in 7

power cox .5877867, n(91)
replace RandomPower = .8006 in 8

power cox .5877867, n(150)
replace RandomPower = .9494 in 9

power cox .5877867, n(26)
replace RandomPower = .3223 in 10

power cox .5877867, n(349)
replace RandomPower = 0.9998 in 11

power cox .5877867, n(142)
replace RandomPower = .9385 in 12

power cox .5877867, n(154)
replace RandomPower = .9542 in 13

power cox .5877867, n(205)
replace RandomPower = .9877 in 14

power cox .5877867, n(222)
replace RandomPower = .9922 in 15

power cox .5877867, n(256)
replace RandomPower = .9969 in 16

power cox .5877867, n(160)
replace RandomPower = .9606 in 17

power cox .5877867, n(958)
replace RandomPower = 1.000 in 18

power cox .5877867, n(104)
replace RandomPower = .8502 in 19

power cox .5877867, n(158)
replace RandomPower = .9586 in 20

power cox .5877867, n(367)
replace RandomPower = 0.9999 in 21

power cox .5877867, n(318)
replace RandomPower = 0.9995 in 22

power cox .5877867, n(256)
replace RandomPower = .9969 in 23

power cox .5877867, n(176)
replace RandomPower = .9737 in 24

power cox .5877867, n(80)
replace RandomPower = .7482 in 25

power cox .5877867, n(26)
replace RandomPower = .3223 in 26

power cox .5877867, n(266)
replace RandomPower = .9977 in 27

power cox .5877867, n(101)
replace RandomPower = .8398 in 28

power cox .5877867, n(112)
replace RandomPower = .8750 in 29

power cox .5877867, n(56)
replace RandomPower = .5946 in 30

power cox .5877867, n(40)
replace RandomPower = .4597 in 31

power cox .5877867, n(305)
replace RandomPower = .9992 in 32

power cox .5877867, n(178)
replace RandomPower = .9751 in 33

power cox .5877867, n(546)
replace RandomPower = 1.000 in 34

power cox .5877867, n(138)
replace RandomPower = .9322 in 35

power cox .5877867, n(65)
replace RandomPower = .6589 in 36

power cox .5877867, n(77)
replace RandomPower = .7320 in 37

power cox .5877867, n(1061)
replace RandomPower = 1.000 in 38

power cox .5877867, n(224)
replace RandomPower = .9926 in 39


/////////////////////////////////////////////////
//					       //
//  		      Xue TC et al.	       //
//			HCC DFS                //
//					       //
/////////////////////////////////////////////////

*Xue et al power estimate using largest study ln(HR)
power cox .2390169, n(26)
replace LargestPower = .0884 in 40

power cox .2390169, n(96)
replace LargestPower = .2150 in 41

power cox .2390169, n(150)
replace LargestPower = .3098 in 42

power cox .2390169, n(91)
replace LargestPower = .2061 in 43

power cox .2390169, n(197)
replace LargestPower = .3887 in 44

power cox .2390169, n(158)
replace LargestPower = .3236 in 45

power cox .2390169, n(101)
replace LargestPower = .2240 in 46

power cox .2390169, n(219)
replace LargestPower = .4241 in 47

power cox .2390169, n(76)
replace LargestPower = .1793 in 48

power cox .2390169, n(84)
replace LargestPower = .1936 in 49

power cox .2390169, n(958)
replace LargestPower = .9590 in 50

power cox .2390169, n(104)
replace LargestPower = .2293 in 51

power cox .2390169, n(160)
replace LargestPower = .3270 in 52

power cox .2390169, n(158)
replace LargestPower = .3236 in 53

power cox .2390169, n(282)
replace LargestPower = .5187 in 54

power cox .2390169, n(178)
replace LargestPower = .3574 in 55

power cox .2390169, n(146)
replace LargestPower = .3029 in 56

*Xue et al power estimate using fixed study ln(HR)
power cox .2311117, n(26)
replace FixedPower = .0852 in 40

power cox .2311117, n(96)
replace FixedPower = .2039 in 41

power cox .2311117, n(150)
replace FixedPower = .2930 in 42

power cox .2311117, n(91)
replace FixedPower = .1955 in 43

power cox .2311117, n(197)
replace FixedPower = .3677 in 44

power cox .2311117, n(158)
replace FixedPower = .3059 in 45

power cox .2311117, n(101)
replace FixedPower = .2122 in 46

power cox .2311117, n(219)
replace FixedPower = .4013 in 47

power cox .2311117, n(76)
replace FixedPower = .1704 in 48

power cox .2311117, n(84)
replace FixedPower = .1838 in 49

power cox .2311117, n(958)
replace FixedPower = .9470 in 50

power cox .2311117, n(104)
replace FixedPower = .2172 in 51

power cox .2311117, n(160)
replace FixedPower = .3091 in 52

power cox .2311117, n(158)
replace FixedPower = .3059 in 53

power cox .2311117, n(282)
replace FixedPower = .4922 in 54

power cox .2311117, n(178)
replace FixedPower = .3379 in 55

power cox .2311117, n(146)
replace FixedPower = .2865 in 56

*Xue et al power estimate using random study ln(HR)
power cox .9042181, n(26)
replace RandomPower = .6351 in 40

power cox .9042181, n(96)
replace RandomPower = .9932 in 41

power cox .9042181, n(150)
replace RandomPower = .9998 in 42

power cox .9042181, n(91)
replace RandomPower = .9907 in 43

power cox .9042181, n(197)
replace RandomPower = 1.000 in 44

power cox .9042181, n(158)
replace RandomPower = .9999 in 45

power cox .9042181, n(101)
replace RandomPower = .9951 in 46

power cox .9042181, n(219)
replace RandomPower = 1.000 in 47

power cox .9042181, n(76)
replace RandomPower = .9762 in 48

power cox .9042181, n(84)
replace RandomPower = .9855 in 49

power cox .9042181, n(958)
replace RandomPower = 1.000 in 50

power cox .9042181, n(104)
replace RandomPower = .9960 in 51

power cox .9042181, n(160)
replace RandomPower = .9999 in 52

power cox .9042181, n(158)
replace RandomPower = .9999 in 53

power cox .9042181, n(282)
replace RandomPower = 1.000 in 54

power cox .9042181, n(178)
replace RandomPower = 1.000 in 55

power cox .9042181, n(146)
replace RandomPower = .9998 in 56

/////////////////////////////////////////////////
//					       //
//  		     Shen M et al.	       //
//		      HCC ICC OS	       //
//					       //
/////////////////////////////////////////////////

*Xue et al power estimate using largest study ln(HR)
power cox .6931472, n(323)
replace LargestPower = 1.000 in 57

power cox .6931472, n(123)
replace LargestPower = .9702 in 58

power cox .6931472, n(281)
replace LargestPower = .9999 in 59

power cox .6931472, n(200)
replace LargestPower = .9984 in 60

*Xue et al power estimate using fixed study ln(HR)
power cox .5822156, n(323)
replace FixedPower = .9995 in 57

power cox .5822156, n(123)
replace FixedPower = .8977 in 58

power cox .5822156, n(281)
replace FixedPower = .9982 in 59

power cox .5822156, n(200)
replace FixedPower = .9845 in 60

*Xue et al power estimate using random study ln(HR)
power cox .5877867, n(323)
replace RandomPower = .9996 in 57

power cox .5877867, n(123)
replace RandomPower = .9031 in 58

power cox .5877867, n(281)
replace RandomPower = .9985 in 59

power cox .5877867, n(200)
replace RandomPower = .9860 in 60


/////////////////////////////////////////////////
//					       //
//  		     Xiao WK et al.	       //
//		       HCC MT OS	       //
//					       //
/////////////////////////////////////////////////

*Xiao et al power estimate using largest study ln(HR)
power cox .4700036, n(150)
replace LargestPower = .8207 in 61

power cox .4700036, n(54)
replace LargestPower = 0.4079 in 62

power cox .4700036, n(318)
replace LargestPower = 0.9872 in 63

*Xiao et al power estimate using fixed study ln(HR)
power cox .6151856, n(150)
replace FixedPower = .9646 in 61

power cox .6151856, n(54)
replace FixedPower = 0.6181 in 62

power cox .6151856, n(318)
replace FixedPower = 0.9998 in 63

*Xiao et al power estimate using random study ln(HR)
power cox .6151856, n(150)
replace RandomPower = .9646 in 61

power cox .6151856, n(54)
replace RandomPower = 0.6181 in 62

power cox .6151856, n(318)
replace RandomPower = 0.9998 in 63


/////////////////////////////////////////////////
//					       //
//  		     Xiao WK et al.	       //
//	             HCC Resec DFS	       //
//					       //
/////////////////////////////////////////////////

*Xiao et al power estimate using largest study ln(HR)
power cox .7419373, n(96)
replace LargestPower = .9530 in 64

power cox .7419373, n(958)
replace LargestPower = 1.000 in 65

*Xiao et al power estimate using fixed study ln(HR)
power cox .7419373, n(96)
replace FixedPower = .9530 in 64

power cox .7419373, n(958)
replace FixedPower = 1.000 in 65

*Xiao et al power estimate using random study ln(HR)
power cox .7419373, n(96)
replace RandomPower = .9530 in 64

power cox .7419373, n(958)
replace RandomPower = 1.000 in 65


/////////////////////////////////////////////////
//					       //
//  		   Paramanathan A et al.       //
//		      HCC Resec OS	       //
//					       // 
/////////////////////////////////////////////////

*Paramanathan et al power estimate using largest study ln(HR)
power cox 1.583094, n(219)
replace LargestPower = 1.000 in 66

power cox 1.583094, n(96)
replace LargestPower = 1.000 in 67

power cox 1.583094, n(101)
replace LargestPower = 1.000 in 68

power cox 1.583094, n(150)
replace LargestPower = 1.000 in 69

*Paramanathan et al power estimate using fixed study ln(HR)
power cox 1.247032, n(219)
replace FixedPower = 1.000 in 66

power cox 1.247032, n(96)
replace FixedPower = 1.000 in 67

power cox 1.247032, n(101)
replace FixedPower = 1.000 in 68

power cox 1.247032, n(150)
replace FixedPower = 1.000 in 69

*Paramanathan et al power estimate using random study ln(HR)
power cox 1.258461, n(219)
replace RandomPower = 1.000 in 66

power cox 1.258461, n(96)
replace RandomPower = 1.000 in 67

power cox 1.258461, n(101)
replace FixedPower = 1.000 in 68

power cox 1.258461, n(150)
replace FixedPower = 1.000 in 69



/////////////////////////////////////////////////
//					       //
//  		      Xiao WK et al.	       //
//		       HCC RFA DFS	       //
//					       //
/////////////////////////////////////////////////

*Xiao et al power estimate using largest study ln(HR)
power cox .0676586, n(192)
replace LargestPower = .3806 in 70

power cox .0676586, n(178)
replace LargestPower = .3574 in 71

*Xiao et al power estimate using fixed study ln(HR)
power cox .0676586, n(192)
replace FixedPower = .0680 in 70

power cox .0676586, n(178)
replace FixedPower = .0657 in 71

*Xiao et al power estimate using random study ln(HR)
power cox .0676586, n(192)
replace RandomPower = .0680 in 70

power cox .0676586, n(178)
replace RandomPower = .0657 in 71

/////////////////////////////////////////////////
//					       //
//  		     Xiao WK et al.	       //
//		      HCC RFA OS	       //
//					       //
/////////////////////////////////////////////////

*Xiao et al power estimate using largest study ln(HR)
power cox .2231435, n(192)
replace LargestPower = .3394 in 72

power cox .2231435, n(178)
replace LargestPower = .3187 in 73

*Xiao et al power estimate using fixed study ln(HR)
power cox .2390169, n(192)
replace FixedPower = .3806 in 72

power cox .2390169, n(178)
replace FixedPower = .3574 in 73

*Xiao et al power estimate using random study ln(HR)
power cox .2390169, n(192)
replace RandomPower = .3806 in 72

power cox .2390169, n(178)
replace RandomPower = .3574 in 73


/////////////////////////////////////////////////
//					       //
//  		      Xiao WK et al.	       //
//		      HCC TACE OS	       //
//					       //
/////////////////////////////////////////////////

*Xiao et al power estimate using largest study ln(HR)
power cox .7608058, n(145)
replace LargestPower = .9956 in 74

power cox .7608058, n(103)
replace LargestPower = .9713 in 75

power cox .7608058, n(112)
replace LargestPower = .9806 in 76

*Xiao et al power estimate using fixed study ln(HR)
power cox .9242589, n(145)
replace FixedPower = .9998 in 74

power cox .9242589, n(103)
replace FixedPower = .9968 in 75

power cox .9242589, n(112)
replace FixedPower = .9983 in 76

*Xiao et al power estimate using random study ln(HR)
power cox .9242589, n(145)
replace RandomPower = .9998 in 74

power cox .9242589, n(103)
replace RandomPower = .9968 in 75

power cox .9242589, n(112)
replace RandomPower = .9983 in 76


/////////////////////////////////////////////////
//					       //
//  		       Sun XD et al.	       //
//		       HCC Trans OS	       //
//					       //
/////////////////////////////////////////////////

*Sun et al power estimate using largest study ln(HR)
power cox .5306283, n(224)
replace LargestPower = .9778 in 77

power cox .5306283, n(160)
replace LargestPower = .9186 in 78

power cox .5306283, n(170)
replace LargestPower = .9331 in 79

power cox .5306283, n(150)
replace LargestPower = .9014 in 80

power cox .5306283, n(280)
replace LargestPower = .9934 in 81

power cox .5306283, n(158)
replace LargestPower = .9154 in 82

power cox .5306283, n(101)
replace LargestPower = .7600 in 83

*Sun et al power estimate using fixed study ln(HR)
power cox .8415672, n(224)
replace FixedPower = 1.000 in 77

power cox .8415672, n(160)
replace FixedPower = .9996 in 78

power cox .8415672, n(170)
replace FixedPower = .9998 in 79

power cox .8415672, n(150)
replace FixedPower = .9993 in 80

power cox .8415672, n(280)
replace FixedPower = 1.000 in 81

power cox .8415672, n(158)
replace FixedPower = .9996 in 82

power cox .8415672, n(101)
replace FixedPower = .9884 in 83

*Sun et al power estimate using random study ln(HR)
power cox 1.007958, n(224)
replace RandomPower = 1.000 in 77

power cox 1.007958, n(160)
replace RandomPower = 1.000 in 78

power cox 1.007958, n(170)
replace RandomPower = 1.000 in 79

power cox 1.007958, n(150)
replace RandomPower = 1.000 in 80

power cox 1.007958, n(280)
replace RandomPower = 1.000 in 81

power cox 1.007958, n(158)
replace RandomPower = 1.000 in 82

power cox 1.007958, n(101)
replace RandomPower = .9990 in 83


/////////////////////////////////////////////////
//					       //
//  		    Sun XD et al.	       //
//		    HCC Trans DFS	       //
//					       //
/////////////////////////////////////////////////

*Sun et al power estimate using largest study ln(HR)
power cox .5653138, n(123)
replace LargestPower = .8800 in 84

power cox .5653138, n(158)
replace LargestPower = .9444 in 85

power cox .5653138, n(167)
replace LargestPower = .9548 in 86

power cox .5653138, n(280)
replace LargestPower = .9972 in 87

power cox .5653138, n(104)
replace LargestPower = .8219 in 88

power cox .5653138, n(101)
replace LargestPower = .8108 in 89

power cox .5653138, n(224)
replace LargestPower = .9884 in 90

power cox .5653138, n(160)
replace LargestPower = .9469 in 91

power cox .5653138, n(170)
replace LargestPower = .9578 in 92

power cox .5653138, n(150)
replace LargestPower = .9334 in 93

*Sun et al power estimate using fixed study ln(HR)
power cox .7178398, n(123)
replace FixedPower = .9783 in 84

power cox .7178398, n(158)
replace FixedPower = .9946 in 85

power cox .7178398, n(167)
replace FixedPower = .9963 in 86

power cox .7178398, n(280)
replace FixedPower = 1.000 in 87

power cox .7178398, n(104)
replace FixedPower = .9555 in 88

power cox .7178398, n(101)
replace FixedPower = .9502 in 89

power cox .7178398, n(224)
replace FixedPower = .9997 in 90

power cox .7178398, n(160)
replace FixedPower = .9951 in 91

power cox .7178398, n(170)
replace FixedPower = .9967 in 92

power cox .7178398, n(150)
replace FixedPower = .9926 in 93

*Sun et al power estimate using random study ln(HR)
power cox 1.283708, n(123)
replace RandomPower = 1.000 in 84

power cox 1.283708, n(158)
replace RandomPower = 1.000 in 85

power cox 1.283708, n(167)
replace RandomPower = 1.000 in 86

power cox 1.283708, n(280)
replace RandomPower = 1.000 in 87

power cox 1.283708, n(104)
replace RandomPower = 1.000 in 88

power cox 1.283708, n(101)
replace RandomPower = 1.000 in 89

power cox 1.283708, n(224)
replace RandomPower = 1.000 in 90

power cox 1.283708, n(160)
replace RandomPower = 1.000 in 91

power cox 1.283708, n(170)
replace RandomPower = 1.000 in 92

power cox 1.283708, n(150)
replace RandomPower = 1.000 in 93

export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Hept.xlsx"


**power of individual studies in respiratory cancers

clear
 
import excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\ExcessAll.xlsx", sheet("Respiratory") firstrow
 
gen LargestPower=.
gen FixedPower=.
gen RandomPower=.

gen LNlargestHR=.
gen LNfixedHR=.
gen LNrandomHR=.

replace LNlargestHR=ln(LargestHR)
replace LNfixedHR=ln(FixedHR)
replace LNrandomHR=ln(RandomHR)
 
/////////////////////////////////////////////////
//					       //
//  	            Zhao QT et al.	       //
//			Lung OS		       //
//					       //
/////////////////////////////////////////////////

*Lung et al power estimate using largest study ln(HR)
power cox .4252677, n(59)
replace LargestPower = .3720 in 1

power cox .4252677, n(1139)
replace LargestPower = .9821 in 2

power cox .4252677, n(138)
replace LargestPower = .7047 in 3

power cox .4252677, n(1157)
replace LargestPower = 1.000 in 4

power cox .4252677, n(1238)
replace LargestPower = 1.000 in 5

power cox .4252677, n(114)
replace LargestPower = .6219 in 6

power cox .4252677, n(187)
replace LargestPower = .8284 in 7

power cox .4252677, n(299)
replace LargestPower = .9570 in 8

power cox .4252677, n(81)
replace LargestPower = .4816 in 9

power cox .4252677, n(220)
replace LargestPower = .8837 in 10

power cox .4252677, n(114)
replace LargestPower = .6219 in 11

power cox .4252677, n(400)
replace LargestPower = .9891 in 12

power cox .4252677, n(255)
replace LargestPower = .9244 in 13

power cox .4252677, n(182)
replace LargestPower = .8182 in 14

power cox .4252677, n(95)
replace LargestPower = .5448 in 15

power cox .4252677, n(173)
replace LargestPower = .7986 in 16

power cox .4252677, n(156)
replace LargestPower = .7567 in 17

power cox .4252677, n(171)
replace LargestPower = .7941 in 18

power cox .4252677, n(199)
replace LargestPower = .8507 in 19

power cox .4252677, n(177)
replace LargestPower = .8076 in 20

power cox .4252677, n(388)
replace LargestPower = .9871 in 21

*Lung et al power estimate using fixed study ln(HR)
power cox .1906204, n(59)
replace FixedPower = .1097 in 1

power cox .1906204, n(1139)
replace FixedPower = .8956 in 2

power cox .1906204, n(138)
replace FixedPower = .2004 in 3

power cox .1906204, n(1157)
replace FixedPower = .9001 in 4

power cox .1906204, n(1238)
replace FixedPower = .9183 in 5

power cox .1906204, n(114)
replace FixedPower = .1730 in 6

power cox .1906204, n(187)
replace FixedPower = .2557 in 7

power cox .1906204, n(299)
replace FixedPower = .3776 in 8

power cox .1906204, n(81)
replace FixedPower = .1352 in 9

power cox .1906204, n(220)
replace FixedPower = .2924 in 10

power cox .1906204, n(114)
replace FixedPower = .1730 in 11

power cox .1906204, n(400)
replace FixedPower = .4786 in 12

power cox .1906204, n(255)
replace FixedPower = .3307 in 13

power cox .1906204, n(182)
replace FixedPower = .2501 in 14

power cox .1906204, n(95)
replace FixedPower = .1513 in 15

power cox .1906204, n(173)
replace FixedPower = .2400 in 16

power cox .1906204, n(156)
replace FixedPower = .2208 in 17

power cox .1906204, n(171)
replace FixedPower = .2377 in 18

power cox .1906204, n(199)
replace FixedPower = .2691 in 19

power cox .1906204, n(177)
replace FixedPower = .2445 in 20

power cox .1906204, n(388)
replace FixedPower = .4671 in 21

*Lung et al power estimate using random study ln(HR)
power cox .4121096, n(59)
replace RandomPower = .3530 in 1

power cox .4121096, n(1139)
replace RandomPower = 1.000 in 2

power cox .4121096, n(138)
replace RandomPower = .6775 in 3

power cox .4121096, n(1157)
replace RandomPower = 1.000 in 4

power cox .4121096, n(1238)
replace RandomPower = 1.000 in 5

power cox .4121096, n(114)
replace RandomPower = .5949 in 6

power cox .4121096, n(187)
replace RandomPower = .8045 in 7

power cox .4121096, n(299)
replace RandomPower = .9455 in 8

power cox .4121096, n(81)
replace RandomPower = .4580 in 9

power cox .4121096, n(220)
replace RandomPower = .8635 in 10

power cox .4121096, n(114)
replace RandomPower = .5949 in 11

power cox .4121096, n(400)
replace RandomPower = .9847 in 12

power cox .4121096, n(255)
replace RandomPower = .9083 in 13

power cox .4121096, n(182)
replace RandomPower = .7939 in 14

power cox .4121096, n(95)
replace RandomPower = .5193 in 15

power cox .4121096, n(173)
replace RandomPower = .7735 in 16

power cox .4121096, n(156)
replace RandomPower = .7303 in 17

power cox .4121096, n(171)
replace RandomPower = .7687 in 18

power cox .4121096, n(199)
replace RandomPower = .8281 in 19

power cox .4121096, n(177)
replace RandomPower = .7827 in 20

power cox .4121096, n(388)
replace RandomPower = .9821 in 21


/////////////////////////////////////////////////
//					       //
//  		  Zhao QT et al.	       //
//		    Lung PFS		       //
//					       //
/////////////////////////////////////////////////

*Lung et al power estimate using largest study ln(HR)
power cox .3920421, n(187)
replace LargestPower = .7644 in 22

power cox .3920421, n(81)
replace LargestPower = .4224 in 23

power cox .3920421, n(112)
replace LargestPower = .5456 in 24

power cox .3920421, n(255)
replace LargestPower = .8790 in 25

power cox .3920421, n(182)
replace LargestPower = .7532 in 26

power cox .3920421, n(173)
replace LargestPower = .7318 in 27

power cox .3920421, n(171)
replace LargestPower = .7269 in 28

power cox .3920421, n(199)
replace LargestPower = .7897 in 29

power cox .3920421, n(388)
replace LargestPower = .9714 in 30

*Lung et al power estimate using fixed study ln(HR)
power cox .2151113, n(187)
replace FixedPower = .3124 in 22

power cox .2151113, n(81)
replace FixedPower = .1606 in 23

power cox .2151113, n(112)
replace FixedPower = .2056 in 24

power cox .2151113, n(255)
replace FixedPower = .4042 in 25

power cox .2151113, n(182)
replace FixedPower = .3054 in 26

power cox .2151113, n(173)
replace FixedPower = .2928 in 27

power cox .2151113, n(171)
replace FixedPower = .2900 in 28

power cox .2151113, n(199)
replace FixedPower = .3290 in 29

power cox .2151113, n(388)
replace FixedPower = .5630 in 30

*Lung et al power estimate using random study ln(HR)
power cox .3074847, n(187)
replace RandomPower = .5566 in 22

power cox .3074847, n(81)
replace RandomPower = .2822 in 23

power cox .3074847, n(112)
replace RandomPower = .3696 in 24

power cox .3074847, n(255)
replace RandomPower = .6897 in 25

power cox .3074847, n(182)
replace RandomPower = .5454 in 26

power cox .3074847, n(173)
replace RandomPower = .5248 in 27

power cox .3074847, n(171)
replace RandomPower = .5201 in 28

power cox .3074847, n(199)
replace RandomPower = .5827 in 29

power cox .3074847, n(388)
replace RandomPower = .8573 in 30



/////////////////////////////////////////////////
//					       //
//  		    Chen et al.		       //
//		      MPM OS		       //
//					       //
/////////////////////////////////////////////////

*Chen et al power estimate using largest study ln(HR)
power cox .0099503, n(52)
replace LargestPower = .0272 in 31

power cox .0099503, n(50)
replace LargestPower = .0271 in 32

power cox .0099503, n(73)
replace LargestPower = .0276 in 33

power cox .0099503, n(148)
replace LargestPower = .0288 in 34

power cox .0099503, n(85)
replace LargestPower = .0278 in 35

power cox .0099503, n(173)
replace LargestPower = .0291 in 36

power cox .0099503, n(274)
replace LargestPower = .0302 in 37

power cox .0099503, n(171)
replace LargestPower = .0291 in 38

power cox .0099503, n(202)
replace LargestPower = .0294 in 39

power cox .0099503, n(150)
replace LargestPower = .0288 in 40

*Chen et al power estimate using fixed study ln(HR)
power cox .2311117, n(52)
replace FixedPower = .1299 in 31

power cox .2311117, n(50)
replace FixedPower = .1265 in 32

power cox .2311117, n(73)
replace FixedPower = .1654 in 33

power cox .2311117, n(148)
replace FixedPower = .2897 in 34

power cox .2311117, n(85)
replace FixedPower = .1855 in 35

power cox .2311117, n(173)
replace FixedPower = .3299 in 36

power cox .2311117, n(274)
replace FixedPower = .4812 in 37

power cox .2311117, n(171)
replace FixedPower = .3268 in 38

power cox .2311117, n(202)
replace FixedPower = .3754 in 39

power cox .2311117, n(150)
replace FixedPower = .2930 in 40

*Chen et al power estimate using random study ln(HR)
power cox .3920421, n(52)
replace RandomPower = .2924 in 31

power cox .3920421, n(50)
replace RandomPower = .2830 in 32

power cox .3920421, n(73)
replace RandomPower = .3878 in 33

power cox .3920421, n(148)
replace RandomPower = .6645 in 34

power cox .3920421, n(85)
replace RandomPower = .4393 in 35

power cox .3920421, n(173)
replace RandomPower = .7318 in 36

power cox .3920421, n(274)
replace RandomPower = .9006 in 37

power cox .3920421, n(171)
replace RandomPower = .7269 in 38

power cox .3920421, n(202)
replace RandomPower = .7956 in 39

power cox .3920421, n(150)
replace RandomPower = .6703 in 40



/////////////////////////////////////////////////
//					       //
//  		      Su L al.		       //
//		      Naso OS		       //
//					       //
/////////////////////////////////////////////////

*Su et al power estimate using largest study ln(HR)
power cox .4510756, n(1410)
replace LargestPower = 1.000 in 41

power cox .4510756, n(229)
replace LargestPower = .9269 in 42

power cox .4510756, n(211)
replace LargestPower = .9059 in 43

power cox .4510756, n(251)
replace LargestPower = .9467 in 44

*Su et al power estimate using fixed study ln(HR)
power cox .5709795, n(1410)
replace FixedPower = 1.000 in 41

power cox .5709795, n(229)
replace FixedPower = .9909 in 42

power cox .5709795, n(211)
replace FixedPower = .9856 in 43

power cox .5709795, n(251)
replace FixedPower = .9948 in 44

*Su et al power estimate using random study ln(HR)
power cox .5709795, n(1410)
replace RandomPower = 1.000 in 41

power cox .5709795, n(229)
replace RandomPower = .9909 in 42

power cox .5709795, n(211)
replace RandomPower = .9856 in 43

power cox .5709795, n(251)
replace RandomPower = .9948 in 44



/////////////////////////////////////////////////
//					       //
//  		     Su L al.	               //
//		     Naso PFS		       //
//					       //
/////////////////////////////////////////////////

*Su et al power estimate using largest study ln(HR)
power cox .5187938, n(1410)
replace LargestPower = 1.000 in 45

power cox .5187938, n(229)
replace LargestPower = .9753 in 46

power cox .5187938, n(211)
replace LargestPower = .9647 in 47

power cox .5187938, n(251)
replace LargestPower = .9948 in 48

*Su et al power estimate using fixed study ln(HR)
power cox .5128236, n(1410)
replace FixedPower = 1.000 in 45

power cox .5128236, n(229)
replace FixedPower = .9726 in 46

power cox .5128236, n(211)
replace FixedPower = .9612 in 47

power cox .5128236, n(251)
replace FixedPower = .9822 in 48

*Su et al power estimate using random study ln(HR)
power cox .5128236, n(1410)
replace RandomPower = 1.000 in 45

power cox .5128236, n(229)
replace RandomPower = .9726 in 46

power cox .5128236, n(211)
replace RandomPower = .9612 in 47

power cox .5128236, n(251)
replace RandomPower = .9822 in 48



/////////////////////////////////////////////////
//		 			       //
//  		    Su L al.		       //
//		   Naso CSS		       //
//					       //
/////////////////////////////////////////////////

*Su et al power estimate using largest study ln(HR)
power cox .3001046, n(363)
replace LargestPower = .8157 in 49

power cox .3001046, n(1895)
replace LargestPower = 1.000 in 50

power cox .3001046, n(62)
replace LargestPower = .2182 in 51

*Su et al power estimate using fixed study ln(HR)
power cox .3506569, n(363)
replace FixedPower = .9163 in 49

power cox .3506569, n(1895)
replace FixedPower = 1.000 in 50

power cox .3506569, n(62)
replace FixedPower = .2812 in 51

*Su et al power estimate using random study ln(HR)
power cox .3506569, n(363)
replace RandomPower = .9163 in 49

power cox .3506569, n(1895)
replace RandomPower = 1.000 in 50

power cox .3506569, n(62)
replace RandomPower = .2812 in 51



/////////////////////////////////////////////////
//					       //
//  		      Gu XB al.		       //
//		      NSCLC OS		       //
//					       //
/////////////////////////////////////////////////

*Gu et al power estimate using largest study ln(HR)
power cox .5247285, n(388)
replace LargestPower = .9993 in 52

power cox .5247285, n(284)
replace LargestPower = .9931 in 53

power cox .5247285, n(171)
replace LargestPower = .9293 in 54

power cox .5247285, n(199)
replace LargestPower = .9592 in 55

power cox .5247285, n(255)
replace LargestPower = .9871 in 56

power cox .5247285, n(173)
replace LargestPower = .9320 in 57

power cox .5247285, n(94)
replace LargestPower = .7203 in 58

power cox .5247285, n(182)
replace LargestPower = .9429 in 59

power cox .5247285, n(299)
replace LargestPower = .9950 in 60

power cox .5247285, n(220)
replace LargestPower = .9733 in 61

power cox .5247285, n(59)
replace LargestPower = .5220 in 62

power cox .5247285, n(81)
replace LargestPower = .6559 in 63

power cox .5247285, n(1139)
replace LargestPower = 1.000 in 64

*Gu et al power estimate using fixed study ln(HR)
power cox .1222176, n(388)
replace FixedPower = .2247 in 52

power cox .1222176, n(284)
replace FixedPower = .1761 in 53

power cox .1222176, n(171)
replace FixedPower = .1228 in 54

power cox .1222176, n(199)
replace FixedPower = .1361 in 55

power cox .1222176, n(255)
replace FixedPower = .1625 in 56

power cox .1222176, n(173)
replace FixedPower = .1238 in 57

power cox .1222176, n(94)
replace FixedPower = .0857 in 58

power cox .1222176, n(182)
replace FixedPower = .1281 in 59

power cox .1222176, n(299)
replace FixedPower = .1832 in 60

power cox .1222176, n(220)
replace FixedPower = .1460 in 61

power cox .1222176, n(59)
replace FixedPower = .0680 in 62

power cox .1222176, n(81)
replace FixedPower = .0793 in 63

*Gu et al power estimate using random study ln(HR)
power cox .5306283, n(388)
replace RandomPower = .9995 in 52

power cox .5306283, n(284)
replace RandomPower = .9940 in 53

power cox .5306283, n(171)
replace RandomPower = .9344 in 54

power cox .5306283, n(199)
replace RandomPower = .9627 in 55

power cox .5306283, n(255)
replace RandomPower = .9886 in 56

power cox .5306283, n(173)
replace RandomPower = .9370 in 57

power cox .5306283, n(94)
replace RandomPower = .7298 in 58

power cox .5306283, n(182)
replace RandomPower = .9473 in 59

power cox .5306283, n(299)
replace RandomPower = .9957 in 60

power cox .5306283, n(220)
replace RandomPower = .9759 in 61

power cox .5306283, n(59)
replace RandomPower = .5311 in 62

power cox .5306283, n(81)
replace RandomPower = .6656 in 63

power cox .5306283, n(1139)
replace RandomPower = 1.000 in 64



/////////////////////////////////////////////////
//					       //
//  		     Gu XB al.		       //
//		    NSCLC PFS		       //
//					       //
/////////////////////////////////////////////////

*Gu et al power estimate using largest study ln(HR)
power cox .3148108, n(388)
replace LargestPower = .8730 in 65

power cox .3148108, n(199)
replace LargestPower = .6028 in 66

power cox .3148108, n(73)
replace LargestPower = .2692 in 67

power cox .3148108, n(39)
replace LargestPower = .1643 in 68

power cox .3148108, n(255)
replace LargestPower = .7101 in 69

power cox .3148108, n(173)
replace LargestPower = .5439 in 70

power cox .3148108, n(94)
replace LargestPower = .3322 in 71

power cox .3148108, n(182)
replace LargestPower = .5650 in 72

power cox .3148108, n(81)
replace LargestPower = .2935 in 73

power cox .3148108, n(1139)
replace LargestPower = .9996 in 74

*Gu et al power estimate using fixed study ln(HR)
power cox .0953102, n(388)
replace FixedPower = .1536 in 65

power cox .0953102, n(199)
replace FixedPower = .0989 in 66

power cox .0953102, n(73)
replace FixedPower = .0602 in 67

power cox .0953102, n(39)
replace FixedPower = .0482 in 68

power cox .0953102, n(255)
replace FixedPower = .1153 in 69

power cox .0953102, n(173)
replace FixedPower = .0912 in 70

power cox .0953102, n(94)
replace FixedPower = .0671 in 71

power cox .0953102, n(182)
replace FixedPower = .0939 in 72

power cox .0953102, n(81)
replace FixedPower = .0629 in 73

power cox .0953102, n(1139)
replace FixedPower = .3626 in 74

*Gu et al power estimate using random study ln(HR)
power cox .48858, n(388)
replace RandomPower = .9978 in 65

power cox .48858, n(199)
replace RandomPower = .9314 in 66

power cox .48858, n(73)
replace RandomPower = .5506 in 67

power cox .48858, n(39)
replace RandomPower = .3320 in 68

power cox .48858, n(255)
replace RandomPower = .9739 in 69

power cox .48858, n(173)
replace RandomPower = .8949 in 70

power cox .48858, n(94)
replace RandomPower = .6586 in 71

power cox .48858, n(182)
replace RandomPower = .9092 in 72

power cox .48858, n(81)
replace RandomPower = .5943 in 73

power cox .48858, n(1139)
replace RandomPower = 1.000 in 74



/////////////////////////////////////////////////
//					       //
//  	               Gu XB al.	       //
//	            NSCLC intra OS	       //
//					       //
/////////////////////////////////////////////////

*Gu et al power estimate using largest study ln(HR)
power cox .14842, n(335)
replace LargestPower = .2737 in 75

power cox .14842, n(632)
replace LargestPower = .4624 in 76

*Gu et al power estimate using fixed study ln(HR)
power cox .14842, n(335)
replace FixedPower = .2737 in 75

power cox .14842, n(632)
replace FixedPower = .4624 in 76

*Gu et al power estimate using random study ln(HR)
power cox .14842, n(335)
replace RandomPower = .2737 in 75

power cox .14842, n(632)
replace RandomPower = .4624 in 76



/////////////////////////////////////////////////
//					       //
//  		     Gu XB al.		       //
//		   NHC intra OS		       //
//					       //
/////////////////////////////////////////////////

*Gu et al power estimate using largest study ln(HR)
power cox .6830968, n(97)
replace LargestPower = .9198 in 77

power cox .6830968, n(83)
replace LargestPower = .8753 in 78

power cox .6830968, n(40)
replace LargestPower = .5793 in 79

*Gu et al power estimate using fixed study ln(HR)
power cox .5247285, n(97)
replace FixedPower = .7337 in 77

power cox .5247285, n(83)
replace FixedPower = .6665 in 78

power cox .5247285, n(40)
replace FixedPower = .3818 in 79

*Gu et al power estimate using random study ln(HR)
power cox .5247285, n(97)
replace RandomPower = .7337 in 77

power cox .5247285, n(83)
replace RandomPower = .6665 in 78

power cox .5247285, n(40)
replace RandomPower = .3818 in 79



export excel "\\ad.ucl.ac.uk\homep\sejjcup\DesktopSettings\Desktop\Excess-Resp.xlsx"


//////END//////
